<HTML>
<HEAD>
   <TITLE> module GridLib (generated by f90doc) </TITLE>
</HEAD>
<H1> Module GridLib </H1>
<PRE>module GridLib

        ! Uses
    use <A HREF="loglib.html">LogLib</A>, ONLY : Catch
    use <A HREF="errorcodes.html">ErrorCodes</A>, ONLY : ncIOError, memAllocError, openFileError, genericIOError, unknownOption
    use <A HREF="chronos.html">Chronos</A>, ONLY : DateTime , UtcNow, ToUtc, DateTimeIsDefault, ASSIGNMENT(=), OPERATOR(-), OPERATOR(+), timeDefault, timeString
    use <A HREF="geolib.html">GeoLib</A>, ONLY : CRS, GEODETIC, UTM, GAUSS_BOAGA, TM, WGS84, ED50, ROME40, SetCRS, SetTransverseMercatorParameters, SetGeodeticParameters

        ! Types
    public type <A HREF="gridlib.html#type_grid_real">grid_real</A>
    public type <A HREF="gridlib.html#type_grid_integer">grid_integer</A>

        ! Variables
    integer (kind=short), public, PARAMETER :: <A HREF="gridlib.html#var_esri_ascii">ESRI_ASCII</A> = 1
    integer (kind=short), public, PARAMETER :: <A HREF="gridlib.html#var_esri_binary">ESRI_BINARY</A> = 2
    integer (kind=short), public, PARAMETER :: <A HREF="gridlib.html#var_net_cdf">NET_CDF</A> = 3
    integer (kind=short), private, PARAMETER :: <A HREF="gridlib.html#var_missing_def_int">MISSING_DEF_INT</A> = -9999
    real (kind=float), private, PARAMETER :: <A HREF="gridlib.html#var_missing_def_real">MISSING_DEF_REAL</A> = -9999.9

        ! Interfaces
    public interface <A HREF="gridlib.html#interface_newgrid">NewGrid</A>
    public interface <A HREF="gridlib.html#interface_exportgrid">ExportGrid</A>
    public interface <A HREF="gridlib.html#interface_griddestroy">GridDestroy</A>
    public interface <A HREF="gridlib.html#interface_setstandardname">SetStandardName</A>
    public interface <A HREF="gridlib.html#interface_setlongname">SetLongName</A>
    public interface <A HREF="gridlib.html#interface_setunits">SetUnits</A>
    public interface <A HREF="gridlib.html#interface_setvaryingmode">SetVaryingMode</A>
    public interface <A HREF="gridlib.html#interface_setreferencetime">SetReferenceTime</A>
    public interface <A HREF="gridlib.html#interface_setcurrenttime">SetCurrentTime</A>
    public interface <A HREF="gridlib.html#interface_setesripestring">SetEsriPeString</A>
    public interface <A HREF="gridlib.html#interface_getgridmapping">GetGridMapping</A>

        ! Subroutines and functions
    private subroutine <A HREF="gridlib.html#subroutine_newgridfloatfromnetcdf">NewGridFloatFromNetCDF</A> (layer, fileName, variable, stdName, time)
    private subroutine <A HREF="gridlib.html#subroutine_newgridintegerfromnetcdf">NewGridIntegerFromNetCDF</A> (layer, fileName, variable, stdName, time)
    private subroutine <A HREF="gridlib.html#subroutine_newgridfloatfromfile">NewGridFloatFromFile</A> (layer, fileName, fileFormat, variable, stdName, time)
    private subroutine <A HREF="gridlib.html#subroutine_newgridfloatfromesri_ascii">NewGridFloatFromESRI_ASCII</A> (fileName, layer)
    private subroutine <A HREF="gridlib.html#subroutine_newgridfloatfromesri_binary">NewGridFloatFromESRI_BINARY</A> (fileName, layer)
    private subroutine <A HREF="gridlib.html#subroutine_newgridintegerfromfile">NewGridIntegerFromFile</A> (layer, fileName, fileFormat, variable, stdName, time)
    private subroutine <A HREF="gridlib.html#subroutine_newgridintegerfromesri_ascii">NewGridIntegerFromESRI_ASCII</A> (fileName, layer)
    private subroutine <A HREF="gridlib.html#subroutine_newgridintegerfromesri_binary">NewGridIntegerFromESRI_BINARY</A> (fileName, layer)
    private subroutine <A HREF="gridlib.html#subroutine_newgridfloatasgridfloat">NewGridFloatAsGridFloat</A> (layer, grid, initial)
    private subroutine <A HREF="gridlib.html#subroutine_newgridfloatasgridinteger">NewGridFloatAsGridInteger</A> (layer, grid, initial)
    private subroutine <A HREF="gridlib.html#subroutine_newgridintegerasgridinteger">NewGridIntegerAsGridInteger</A> (layer, grid, initial)
    private subroutine <A HREF="gridlib.html#subroutine_newgridintegerasgridfloat">NewGridIntegerAsGridFloat</A> (layer, grid, initial)
    private subroutine <A HREF="gridlib.html#subroutine_setstandardnamefloat">SetStandardNameFloat</A> (name, layer)
    private subroutine <A HREF="gridlib.html#subroutine_setstandardnameinteger">SetStandardNameInteger</A> (name, layer)
    private subroutine <A HREF="gridlib.html#subroutine_setlongnamefloat">SetLongNameFloat</A> (name, layer)
    private subroutine <A HREF="gridlib.html#subroutine_setlongnameinteger">SetLongNameInteger</A> (name, layer)
    private subroutine <A HREF="gridlib.html#subroutine_setunitsfloat">SetUnitsFloat</A> (units, layer)
    private subroutine <A HREF="gridlib.html#subroutine_setunitsinteger">SetUnitsInteger</A> (units, layer)
    private subroutine <A HREF="gridlib.html#subroutine_setvaryingmodefloat">SetVaryingModeFloat</A> (varMod, layer)
    private subroutine <A HREF="gridlib.html#subroutine_setvaryingmodeinteger">SetVaryingModeInteger</A> (varMod, layer)
    private subroutine <A HREF="gridlib.html#subroutine_setreferencetimefloat">SetReferenceTimeFloat</A> (time, layer)
    private subroutine <A HREF="gridlib.html#subroutine_setreferencetimeinteger">SetReferenceTimeInteger</A> (time, layer)
    private subroutine <A HREF="gridlib.html#subroutine_setcurrenttimefloat">SetCurrentTimeFloat</A> (time, layer)
    private subroutine <A HREF="gridlib.html#subroutine_setcurrenttimeinteger">SetCurrentTimeInteger</A> (time, layer)
    private subroutine <A HREF="gridlib.html#subroutine_setesripestringfloat">SetEsriPeStringFloat</A> (string, layer)
    private subroutine <A HREF="gridlib.html#subroutine_setesripestringinteger">SetEsriPeStringInteger</A> (string, layer)
    private subroutine <A HREF="gridlib.html#subroutine_exportgridfloattonetcdf">ExportGridFloatToNetCDF</A> (grid, file, name, action)
    public subroutine <A HREF="gridlib.html#subroutine_exportgridintegertonetcdf">ExportGridIntegerToNetCDF</A> (grid, file, name, action)
    private subroutine <A HREF="gridlib.html#subroutine_exportgridfloattofile">ExportGridFloatToFile</A> (layer, fileName, fileFormat)
    private subroutine <A HREF="gridlib.html#subroutine_exportgridfloattoesri_ascii">ExportGridFloatToESRI_ASCII</A> (layer, fileName)
    private subroutine <A HREF="gridlib.html#subroutine_exportgridfloattoesri_binary">ExportGridFloatToESRI_BINARY</A> (layer, fileName)
    private subroutine <A HREF="gridlib.html#subroutine_exportgridintegertofile">ExportGridIntegerToFile</A> (layer, fileName, fileFormat)
    private subroutine <A HREF="gridlib.html#subroutine_exportgridintegertoesri_ascii">ExportGridIntegerToESRI_ASCII</A> (layer, fileName)
    private subroutine <A HREF="gridlib.html#subroutine_exportgridintegertoesri_binary">ExportGridIntegerToESRI_BINARY</A> (layer, fileName)
    private subroutine <A HREF="gridlib.html#subroutine_getgeoreferencefromncdataset">GetGeoreferenceFromNCdataSet</A> (ncId, varId, cellsize, xll, yll, grid_mapping)
    private subroutine <A HREF="gridlib.html#subroutine_getxysizesfromfile">GetXYSizesFromFile</A> (ncId, x, y, idx, idy, shape)
    private function <A HREF="gridlib.html#function_timeindex">TimeIndex</A> (ncId, refTime, timeUnit, time) result (index)
    private function <A HREF="gridlib.html#function_nexttime">NextTime</A> (ncId, refTime, timeUnit, current) result (time)
    private subroutine <A HREF="gridlib.html#subroutine_parsetime">ParseTime</A> (ncId, ref_time, time_unit)
    public function <A HREF="gridlib.html#function_getgridmappingfloat">GetGridMappingFloat</A> (layer) result (grid_mapping)
    public function <A HREF="gridlib.html#function_getgridmappinginteger">GetGridMappingInteger</A> (layer) result (grid_mapping)
    private subroutine <A HREF="gridlib.html#subroutine_griddestroyfloat">GridDestroyFloat</A> (layer)
    private subroutine <A HREF="gridlib.html#subroutine_griddestroyinteger">GridDestroyInteger</A> (layer)
    private subroutine <A HREF="gridlib.html#subroutine_swapgridrealforward">SwapGridRealForward</A> (matIn, matOut)
    private subroutine <A HREF="gridlib.html#subroutine_swapgridintegerforward">SwapGridIntegerForward</A> (matIn, matOut)
    private subroutine <A HREF="gridlib.html#subroutine_swapgridrealback">SwapGridRealBack</A> (matIn, matOut)
    private subroutine <A HREF="gridlib.html#subroutine_swapgridintegerback">SwapGridIntegerBack</A> (matIn, matOut)
    public subroutine <A HREF="gridlib.html#subroutine_ncerrorhandler">ncErrorHandler</A> (errcode)
    public function <A HREF="gridlib.html#function_getdtgrid">GetDtGrid</A> (filename, checkRegular) result (dt)

end module GridLib
</PRE>
 This file is part of 
<P>
   MOSAICO -- MOdular library for raSter bAsed hydrologIcal appliCatiOn.
<P>
   Copyright (C) 2011 Giovanni Ravazzani
<P>
   This program is free software: you can redistribute it and/or modify
   it under the terms of the GNU General Public License as published by
   the Free Software Foundation, either version 3 of the License, or
   (at your option) any later version.
<P>
   This program is distributed in the hope that it will be useful,
   but WITHOUT ANY WARRANTY; without even the implied warranty of
   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
   GNU General Public License for more details.
<P>
   You should have received a copy of the GNU General Public License
   along with this program.  If not, see <http://www.gnu.org/licenses/>.
 Module Description: 
   set of fortran routines to manage input and output of grids.
   The module supports different file formats:    
   NetCDF raster layer CF 1.0 compliant (Climate and Forecast metadata standard)
   ESRI ASCII grid
   ESRI BINARY grid
<P>
   The module introduces two new variable types:
   grid_real to store floating point data, and
   grid_integer to store integer data.
   To initialize a new grid variable, either integer or float, you can:
<P>
   read grid from NetCdf file passing the standard name:
<PRE>    TYPE(grid_real) :: new_grid
    CALL NewGrid (new_grid, NetCdfFileName, stdName='air_temperature')</PRE>
<P>
   read grid from NetCdf file passing name of variable:
<PRE>    TYPE(grid_real) :: new_grid
    CALL NewGrid (new_grid, NetCdfFileName, variable = 'T2m')</PRE>
<P>
   If NetCdf archive is multitemporal, that is contains more grids,
   one for each time, you can retrieve the grid for a given time:
<PRE>    TYPE(grid_real) :: new_grid
    TYPE (DateTime) :: ncTime
    ncTime = '2007-03-05T11:00:00+00:00'
    CALL NewGrid (new_grid, NetCdfFileName, stdName='air_temperature', time = ncTime) </PRE>
<P>
   Read grid from ESRI ASCII file:
<PRE>     TYPE(grid_real) :: new_grid
     fileName = 'file.asc'
     CALL NewGrid (new_grid, fileName, ESRI_ASCII)</PRE>
<P>
   Read grid from ESRI BINARY file:
<PRE>     TYPE(grid_real) :: new_grid
     fileName = 'file'
     CALL NewGrid (new_grid, fileName, ESRI_BINARY)</PRE>
<P>
   Initialize grid using an existing one as template. The new grid
   is initialized with value 0:
<PRE>     TYPE(grid_real) :: template
     TYPE(grid_integer) :: new_Grid
     CALL NewGrid (newGrid, template) </PRE>
   If you want assign an initial value different than 0:
<PRE>     CALL NewGrid (new_Grid, template, 100)
   The initial value must be of the same type as values stored in grid
 
   To export a grid to a file you can:

   write the grid to a netcdf file as variable termed VariableName:
    TYPE(grid_real) :: grid
      ... some statements that assign data to grid
    CALL ExportGrid (grid, NetCdfFileName, VariableName, 'add')</PRE>
   If the netcdf file is multitemporal, you can add grid to already existing ones in file:
<PRE>    TYPE(grid_real) :: grid
      ... some statements that assign data to grid
    CALL ExportGrid (grid, NetCdfFileName, VariableName, 'append')</PRE>
   If NetCdfFileName does not exist, it is created.
<P>
   Write the grid to ESRI ASCII or BINARY file:
<PRE>    TYPE(grid_real) :: grid
      ... some statements that assign data to grid
    fileName = 'file.asc'
    CALL ExportGrid (grid, fileName, ESRI_ASCII)
    fileName = 'file' 
    CALL ExportGrid (grid, fileName, ESRI_BINARY)</PRE>
<P>
   If a grid is no more used you can free memory:
<PRE>    TYPE(grid_real) :: grid
      ... some statements that assign data to grid
    CALL GridDestroy (grid)</PRE>
<P>
 References:
   NetCDF: http://www.unidata.ucar.edu/software/netcdf/
   CF 1.0: http://cf-pcmdi.llnl.gov/
   UDUNITS: http://www.unidata.ucar.edu/software/udunits/
<P>
<STRONG>Author:</STRONG> <a href="mailto:giovanni.ravazzani@polimi.it">Giovanni Ravazzani</a>
<P>
<STRONG>Version:</STRONG> 0.9 - 17th Jun 2011

<HR><H2> Description of Types </H2>
<A NAME="type_grid_real"><H3>grid_real</H3></A>
<PRE>public type grid_real
    integer (kind=short) :: jdim
</PRE>
<DL><DD><DL><DD>
number of columns
</DL></DL>
<PRE>    integer (kind=short) :: idim
</PRE>
<DL><DD><DL><DD>
number of rows
</DL></DL>
<PRE>    character (len=300) :: standard_name
</PRE>
<DL><DD><DL><DD>
 CF 1.0 compliant standard name
</DL></DL>
<PRE>    character (len=300) :: var_name
</PRE>
<DL><DD><DL><DD>
 name of the variable
</DL></DL>
<PRE>    character (len=300) :: long_name
</PRE>
<DL><DD><DL><DD>
 long descriptive name
</DL></DL>
<PRE>    character (len=300) :: file_name
</PRE>
<DL><DD><DL><DD>
 name of the file from which grid was read
</DL></DL>
<PRE>    character (len=30) :: units
</PRE>
<DL><DD><DL><DD>
UDUNITS compliant measure units
</DL></DL>
<PRE>    character (len=20) :: varying_mode
</PRE>
<DL><DD><DL><DD>
mode to vary: sequence, linear
</DL></DL>
<PRE>    real (kind=float) :: nodata
</PRE>
<DL><DD><DL><DD>
scalar identifying missing value
</DL></DL>
<PRE>    real (kind=float) :: valid_min
</PRE>
<DL><DD><DL><DD>
minimum valid value
</DL></DL>
<PRE>    real (kind=float) :: valid_max
</PRE>
<DL><DD><DL><DD>
maximum valid value
</DL></DL>
<PRE>    type (DateTime) :: reference_time
</PRE>
<DL><DD><DL><DD>
reference time from which calculate current
</DL></DL>
<PRE>    type (DateTime) :: current_time
</PRE>
<DL><DD><DL><DD>
current date and time of the grid in memory
</DL></DL>
<PRE>    type (DateTime) :: next_time
</PRE>
<DL><DD><DL><DD>
time when next update is required
</DL></DL>
<PRE>    integer (kind=short) :: time_index
</PRE>
<DL><DD><DL><DD>
position of grid in time dimension in netcdf file
</DL></DL>
<PRE>    character (len=7) :: time_unit
</PRE>
<DL><DD><DL><DD>
define time unit. Accepted values are: 
</DL></DL>
<PRE>    real (kind=float), ALLOCATABLE, dimension (:,:) :: mat
</PRE>
<DL><DD><DL><DD>
seconds, second, sec, s
minutes, minute, min
hours, hour, hr, h
days, day, d
data variable contained in grid
</DL></DL>
<PRE>    real (kind=float) :: cellsize
</PRE>
<DL><DD><DL><DD>
georeferencing informations
</DL></DL>
<PRE>    real (kind=float) :: xllcorner
    real (kind=float) :: yllcorner
    character (len=1000) :: esri_pe_string
</PRE>
<DL><DD><DL><DD>
used by ArcMap 9.2
</DL></DL>
<PRE>    type (CRS) :: grid_mapping
</PRE>
<DL><DD><DL><DD>
Coordinate reference System
</DL></DL>
<PRE>end type grid_real
</PRE>
spatial conventions in netCDF file:
<P>
<PRE>       y
  yDim ^     N
       |
       |  W     E
       |
       |     S
     1 |---------> x
        1        xDim</PRE>
<P>
index conventions: GRID(x,y)
spatial conventions used in GridLib:
<P>
<PRE>       1        jdim
     1 |---------> j
       |     N
       |
       |  W     E
       |
       |     S
 idim  v
       i</PRE>
<P>
index conventions: GRID(i,j)
<A NAME="type_grid_integer"><H3>grid_integer</H3></A>
<PRE>public type grid_integer
    integer (kind=short) :: jdim
</PRE>
<DL><DD><DL><DD>
number of columns
</DL></DL>
<PRE>    integer (kind=short) :: idim
</PRE>
<DL><DD><DL><DD>
number of rows
</DL></DL>
<PRE>    character (len=300) :: standard_name
</PRE>
<DL><DD><DL><DD>
 CF 1.0 compliant standard name
</DL></DL>
<PRE>    character (len=300) :: var_name
</PRE>
<DL><DD><DL><DD>
 name of the variable
</DL></DL>
<PRE>    character (len=300) :: long_name
</PRE>
<DL><DD><DL><DD>
 long descriptive name
</DL></DL>
<PRE>    character (len=300) :: file_name
</PRE>
<DL><DD><DL><DD>
 name of the file from which grid was read
</DL></DL>
<PRE>    character (len=30) :: units
</PRE>
<DL><DD><DL><DD>
UDUNITS compliant measure units
</DL></DL>
<PRE>    character (len=20) :: varying_mode
</PRE>
<DL><DD><DL><DD>
mode to vary: steady, sequence, linear
</DL></DL>
<PRE>    integer (kind=long) :: nodata
</PRE>
<DL><DD><DL><DD>
scalar identifying missing value
</DL></DL>
<PRE>    integer (kind=long) :: valid_min
</PRE>
<DL><DD><DL><DD>
minimum valid value
</DL></DL>
<PRE>    integer (kind=long) :: valid_max
</PRE>
<DL><DD><DL><DD>
maximum valid value
</DL></DL>
<PRE>    type (DateTime) :: reference_time
</PRE>
<DL><DD><DL><DD>
reference time from which calculate current
</DL></DL>
<PRE>    type (DateTime) :: current_time
</PRE>
<DL><DD><DL><DD>
current date and time of the grid in memory
</DL></DL>
<PRE>    type (DateTime) :: next_time
</PRE>
<DL><DD><DL><DD>
time when next update is required
</DL></DL>
<PRE>    integer (kind=short) :: time_index
</PRE>
<DL><DD><DL><DD>
position of grid in time dimension in netcdf file
</DL></DL>
<PRE>    character (len=7) :: time_unit
</PRE>
<DL><DD><DL><DD>
define time unit. Accepted values are: 
</DL></DL>
<PRE>    integer (kind=long), ALLOCATABLE, dimension (:,:) :: mat
</PRE>
<DL><DD><DL><DD>
seconds, second, sec, s
minutes, minute, min
hours, hour, hr, h
days, day, d
data contained in grid
</DL></DL>
<PRE>    real (kind=float) :: cellsize
</PRE>
<DL><DD><DL><DD>
georeferencing informations
</DL></DL>
<PRE>    real (kind=float) :: xllcorner
    real (kind=float) :: yllcorner
    character (len=1000) :: esri_pe_string
</PRE>
<DL><DD><DL><DD>
used by ArcMap 9.2
</DL></DL>
<PRE>    type (CRS) :: grid_mapping
</PRE>
<DL><DD><DL><DD>
Coordinate reference System
</DL></DL>
<PRE>end type grid_integer
</PRE>

<HR><H2> Description of Variables </H2>
<A NAME="var_esri_ascii"><H3>ESRI_ASCII</H3></A>
<PRE>integer (kind=short), public, PARAMETER :: ESRI_ASCII = 1
</PRE>
<A NAME="var_esri_binary"><H3>ESRI_BINARY</H3></A>
<PRE>integer (kind=short), public, PARAMETER :: ESRI_BINARY = 2
</PRE>
<A NAME="var_net_cdf"><H3>NET_CDF</H3></A>
<PRE>integer (kind=short), public, PARAMETER :: NET_CDF = 3
</PRE>
<A NAME="var_missing_def_int"><H3>MISSING_DEF_INT</H3></A>
<PRE>integer (kind=short), private, PARAMETER :: MISSING_DEF_INT = -9999
</PRE>
<A NAME="var_missing_def_real"><H3>MISSING_DEF_REAL</H3></A>
<PRE>real (kind=float), private, PARAMETER :: MISSING_DEF_REAL = -9999.9
</PRE>

<HR><H2> Description of Interfaces </H2>
<A NAME="interface_newgrid"><H3>NewGrid</H3></A>
<PRE>public interface NewGrid
    module procedure <A HREF="#subroutine_newgridfloatfromfile">NewGridFloatFromFile</A>
    module procedure <A HREF="#subroutine_newgridintegerfromfile">NewGridIntegerFromFile</A>
    module procedure <A HREF="#subroutine_newgridfloatasgridfloat">NewGridFloatAsGridFloat</A>
    module procedure <A HREF="#subroutine_newgridfloatasgridinteger">NewGridFloatAsGridInteger</A>
    module procedure <A HREF="#subroutine_newgridintegerasgridinteger">NewGridIntegerAsGridInteger</A>
    module procedure <A HREF="#subroutine_newgridintegerasgridfloat">NewGridIntegerAsGridFloat</A>
end interface NewGrid
</PRE>
<A NAME="interface_exportgrid"><H3>ExportGrid</H3></A>
<PRE>public interface ExportGrid
    module procedure <A HREF="#subroutine_exportgridfloattonetcdf">ExportGridFloatToNetCDF</A>
    module procedure <A HREF="#subroutine_exportgridintegertonetcdf">ExportGridIntegerToNetCDF</A>
    module procedure <A HREF="#subroutine_exportgridfloattofile">ExportGridFloatToFile</A>
    module procedure <A HREF="#subroutine_exportgridintegertofile">ExportGridIntegerToFile</A>
end interface ExportGrid
</PRE>
<A NAME="interface_griddestroy"><H3>GridDestroy</H3></A>
<PRE>public interface GridDestroy
    module procedure <A HREF="#subroutine_griddestroyfloat">GridDestroyFloat</A>
    module procedure <A HREF="#subroutine_griddestroyinteger">GridDestroyInteger</A>
end interface GridDestroy
</PRE>
<A NAME="interface_setstandardname"><H3>SetStandardName</H3></A>
<PRE>public interface SetStandardName
    module procedure <A HREF="#subroutine_setstandardnamefloat">SetStandardNameFloat</A>
    module procedure <A HREF="#subroutine_setstandardnameinteger">SetStandardNameInteger</A>
end interface SetStandardName
</PRE>
<A NAME="interface_setlongname"><H3>SetLongName</H3></A>
<PRE>public interface SetLongName
    module procedure <A HREF="#subroutine_setlongnamefloat">SetLongNameFloat</A>
    module procedure <A HREF="#subroutine_setlongnameinteger">SetLongNameInteger</A>
end interface SetLongName
</PRE>
<A NAME="interface_setunits"><H3>SetUnits</H3></A>
<PRE>public interface SetUnits
    module procedure <A HREF="#subroutine_setunitsfloat">SetUnitsFloat</A>
    module procedure <A HREF="#subroutine_setunitsinteger">SetUnitsInteger</A>
end interface SetUnits
</PRE>
<A NAME="interface_setvaryingmode"><H3>SetVaryingMode</H3></A>
<PRE>public interface SetVaryingMode
    module procedure <A HREF="#subroutine_setvaryingmodefloat">SetVaryingModeFloat</A>
    module procedure <A HREF="#subroutine_setvaryingmodeinteger">SetVaryingModeInteger</A>
end interface SetVaryingMode
</PRE>
<A NAME="interface_setreferencetime"><H3>SetReferenceTime</H3></A>
<PRE>public interface SetReferenceTime
    module procedure <A HREF="#subroutine_setreferencetimefloat">SetReferenceTimeFloat</A>
    module procedure <A HREF="#subroutine_setreferencetimeinteger">SetReferenceTimeInteger</A>
end interface SetReferenceTime
</PRE>
<A NAME="interface_setcurrenttime"><H3>SetCurrentTime</H3></A>
<PRE>public interface SetCurrentTime
    module procedure <A HREF="#subroutine_setcurrenttimefloat">SetCurrentTimeFloat</A>
    module procedure <A HREF="#subroutine_setcurrenttimeinteger">SetCurrentTimeInteger</A>
end interface SetCurrentTime
</PRE>
<A NAME="interface_setesripestring"><H3>SetEsriPeString</H3></A>
<PRE>public interface SetEsriPeString
    module procedure <A HREF="#subroutine_setesripestringfloat">SetEsriPeStringFloat</A>
    module procedure <A HREF="#subroutine_setesripestringinteger">SetEsriPeStringInteger</A>
end interface SetEsriPeString
</PRE>
<A NAME="interface_getgridmapping"><H3>GetGridMapping</H3></A>
<PRE>public interface GetGridMapping
    module procedure <A HREF="#function_getgridmappingfloat">GetGridMappingFloat</A>
    module procedure <A HREF="#function_getgridmappinginteger">GetGridMappingInteger</A>
end interface GetGridMapping
</PRE>

<HR><H2> Description of Subroutines and Functions </H2>
<A NAME="subroutine_newgridfloatfromnetcdf"><H3>NewGridFloatFromNetCDF</H3></A>
<PRE>private subroutine NewGridFloatFromNetCDF (layer, fileName, variable, stdName, time)
    type (grid_real), INTENT (out) :: layer
</PRE>
<DL><DD><DL><DD>
gridreal to return
</DL></DL>
<PRE>    character (len=*), INTENT(in) :: fileName
</PRE>
<DL><DD><DL><DD>
NetCDF file to be read
</DL></DL>
<PRE>    character (len=*), optional, INTENT(in) :: variable
</PRE>
<DL><DD><DL><DD>
<PRE> ariable  to read</PRE>
</DL></DL>
<PRE>    character (len=*), optional, INTENT(in) :: stdName
</PRE>
<DL><DD><DL><DD>
standard name of 
</DL></DL>
<PRE>    type (DateTime), optional, INTENT(in) :: time
</PRE>
<DL><DD><DL><DD>
the variable  to read
time of the grid to read
</DL></DL>
<PRE>    ! Calls: Catch, GetGeoreferenceFromNCdataSet, GetXYSizesFromFile, ParseTime, SwapGridRealForward, ncErrorHandler
end subroutine NewGridFloatFromNetCDF
</PRE>
 Description:
  create a new raster_real reading data from NetCDF file
  The variable to read can be defined by its current name or 
  the standard_name. The dimensions x and y of the variable
  is calculated searching from the dimensions of the couple of 
  variables with 'standard_name' equal to 'projection_x_coordinate'
  and 'projection_y_coordinate' for projected reference systems
  or 'longitude' and 'latitude' for geographic reference systems
  or 'grid_longitude' and 'grid_latitude' for rotated pole systems
  If a comprehensible reference systems is not found a geodetic
  reference system is supposed.
  Once the variable is retrieved, offset and scale factor are applied
  and a check on minimum and maximum valid value is performed.
<A NAME="subroutine_newgridintegerfromnetcdf"><H3>NewGridIntegerFromNetCDF</H3></A>
<PRE>private subroutine NewGridIntegerFromNetCDF (layer, fileName, variable, stdName, time)
    type (grid_integer), INTENT (out) :: layer
</PRE>
<DL><DD><DL><DD>
gridreal to return
</DL></DL>
<PRE>    character (len=*), INTENT(in) :: fileName
</PRE>
<DL><DD><DL><DD>
NetCDF file to read
</DL></DL>
<PRE>    character (len=*), optional, INTENT(in) :: variable
</PRE>
<DL><DD><DL><DD>
<PRE> ariable  to read</PRE>
</DL></DL>
<PRE>    character (len=*), optional, INTENT(in) :: stdName
</PRE>
<DL><DD><DL><DD>
standard name of 
</DL></DL>
<PRE>    type (DateTime), optional, INTENT(in) :: time
</PRE>
<DL><DD><DL><DD>
the variable  to read
time of the grid to read
</DL></DL>
<PRE>    ! Calls: Catch, GetGeoreferenceFromNCdataSet, GetXYSizesFromFile, ParseTime, SwapGridIntegerForward, ncErrorHandler
end subroutine NewGridIntegerFromNetCDF
</PRE>
 Description:
  create a new grid_integer reading data from NetCDF file
  The variable to read can be defined by its current name or 
  the standard_name. The dimensions x and j of the variable
  is calculated searching from the dimensions of the couple of 
  variables with 'standard_name' equal to 'projection_x_coordinate'
  and 'projection_y_coordinate' for projected reference systems
  or 'longitude' and 'latitude' for geographic reference systems
  or 'grid_longitude' and 'grid_latitude' for rotated pole systems
  If a comprehensible reference systems is not found a geodetic
  reference system is supposed.
  Once the variable is retrieved, offset and scale factor are applied
  and a check on minimum and maximum valid value is performed.
<A NAME="subroutine_newgridfloatfromfile"><H3>NewGridFloatFromFile</H3></A>
<PRE>private subroutine NewGridFloatFromFile (layer, fileName, fileFormat, variable, stdName, time)
    type (grid_real), INTENT(OUT) :: layer
</PRE>
<DL><DD><DL><DD>
gridreal to return
</DL></DL>
<PRE>    character (len=*), INTENT(IN) :: fileName
</PRE>
<DL><DD><DL><DD>
 file to read
</DL></DL>
<PRE>    integer (kind=short), INTENT(IN) :: fileFormat
</PRE>
<DL><DD><DL><DD>
 format of the file to read
</DL></DL>
<PRE>    character (len=*), optional, INTENT(in) :: variable
</PRE>
<DL><DD><DL><DD>
<PRE> ariable  to read</PRE>
</DL></DL>
<PRE>    character (len=*), optional, INTENT(in) :: stdName
</PRE>
<DL><DD><DL><DD>
standard name of 
</DL></DL>
<PRE>    type (DateTime), optional, INTENT(in) :: time
</PRE>
<DL><DD><DL><DD>
the variable  to read
time of the grid to read
</DL></DL>
<PRE>    ! Calls: Catch, NewGridFloatFromESRI_ASCII, NewGridFloatFromESRI_BINARY, NewGridFloatFromNetCDF
end subroutine NewGridFloatFromFile
</PRE>
 Description:
  read a grid from a file.
  List of supported format:
  ESRI_ASCII: ESRI ASCII GRID
  ESRI_BINARY: ESRI BINARY GRID 
  NET_CDF: NetCDF CF compliant
<A NAME="subroutine_newgridfloatfromesri_ascii"><H3>NewGridFloatFromESRI_ASCII</H3></A>
<PRE>private subroutine NewGridFloatFromESRI_ASCII (fileName, layer)
    character (len=*), INTENT(in) :: fileName
</PRE>
<DL><DD><DL><DD>
 file to read
</DL></DL>
<PRE>    type (grid_real), INTENT (OUT) :: layer
</PRE>
<DL><DD><DL><DD>
returned grid float
</DL></DL>
<PRE>    ! Calls: Catch
end subroutine NewGridFloatFromESRI_ASCII
</PRE>
 Description:
  read a float grid from a ESRI ASCII file.
<A NAME="subroutine_newgridfloatfromesri_binary"><H3>NewGridFloatFromESRI_BINARY</H3></A>
<PRE>private subroutine NewGridFloatFromESRI_BINARY (fileName, layer)
    character (len=*), INTENT(in) :: fileName
</PRE>
<DL><DD><DL><DD>
 file to read
</DL></DL>
<PRE>    type (grid_real), INTENT (OUT) :: layer
</PRE>
<DL><DD><DL><DD>
returned grid float
</DL></DL>
<PRE>    ! Calls: Catch
end subroutine NewGridFloatFromESRI_BINARY
</PRE>
 Description:
  read a float grid from a ESRI BINARY file.
<A NAME="subroutine_newgridintegerfromfile"><H3>NewGridIntegerFromFile</H3></A>
<PRE>private subroutine NewGridIntegerFromFile (layer, fileName, fileFormat, variable, stdName, time)
    type (grid_integer), INTENT(OUT) :: layer
</PRE>
<DL><DD><DL><DD>
grid to be returned
</DL></DL>
<PRE>    character (len=*), INTENT(IN) :: fileName
</PRE>
<DL><DD><DL><DD>
 file to read
</DL></DL>
<PRE>    integer (kind=short), INTENT(IN) :: fileFormat
</PRE>
<DL><DD><DL><DD>
 format of the file to read
</DL></DL>
<PRE>    character (len=*), optional, INTENT(in) :: variable
</PRE>
<DL><DD><DL><DD>
<PRE> ariable  to read</PRE>
</DL></DL>
<PRE>    character (len=*), optional, INTENT(in) :: stdName
</PRE>
<DL><DD><DL><DD>
standard name of 
</DL></DL>
<PRE>    type (DateTime), optional, INTENT(in) :: time
</PRE>
<DL><DD><DL><DD>
the variable  to read
time of the grid to read
</DL></DL>
<PRE>    ! Calls: Catch, NewGridIntegerFromESRI_ASCII, NewGridIntegerFromESRI_BINARY, NewGridIntegerFromNetCDF
end subroutine NewGridIntegerFromFile
</PRE>
 Description:
  read a grid from a file.
  List of supported format:
  ESRI_ASCII: ESRI ASCII GRID
  ESRI_BINARY: ESRI BINARY GRID 
<A NAME="subroutine_newgridintegerfromesri_ascii"><H3>NewGridIntegerFromESRI_ASCII</H3></A>
<PRE>private subroutine NewGridIntegerFromESRI_ASCII (fileName, layer)
    character (len=*), INTENT(in) :: fileName
</PRE>
<DL><DD><DL><DD>
 file to read
</DL></DL>
<PRE>    type (grid_integer), INTENT (OUT) :: layer
</PRE>
<DL><DD><DL><DD>
returned grid float
</DL></DL>
<PRE>    ! Calls: Catch
end subroutine NewGridIntegerFromESRI_ASCII
</PRE>
 Description:
  read a integer grid from a ESRI ASCII file.
<A NAME="subroutine_newgridintegerfromesri_binary"><H3>NewGridIntegerFromESRI_BINARY</H3></A>
<PRE>private subroutine NewGridIntegerFromESRI_BINARY (fileName, layer)
    character (len=*), INTENT(in) :: fileName
</PRE>
<DL><DD><DL><DD>
 file to read
</DL></DL>
<PRE>    type (grid_integer), INTENT (OUT) :: layer
</PRE>
<DL><DD><DL><DD>
returned grid float
</DL></DL>
<PRE>    ! Calls: Catch
end subroutine NewGridIntegerFromESRI_BINARY
</PRE>
 Description:
  read a integer grid from a ESRI BINARY file.
<A NAME="subroutine_newgridfloatasgridfloat"><H3>NewGridFloatAsGridFloat</H3></A>
<PRE>private subroutine NewGridFloatAsGridFloat (layer, grid, initial)
    type (grid_real), INTENT(OUT) :: layer
</PRE>
<DL><DD><DL><DD>
grid to be returned
</DL></DL>
<PRE>    type (grid_real), INTENT(in) :: grid
    real (kind=float), optional, INTENT(in) :: initial
    ! Calls: Catch
end subroutine NewGridFloatAsGridFloat
</PRE>
 Description:
  create a new grid_real using an existing grid_real as template
<A NAME="subroutine_newgridfloatasgridinteger"><H3>NewGridFloatAsGridInteger</H3></A>
<PRE>private subroutine NewGridFloatAsGridInteger (layer, grid, initial)
    type (grid_real), INTENT(OUT) :: layer
</PRE>
<DL><DD><DL><DD>
gridreal to return
</DL></DL>
<PRE>    type (grid_integer), INTENT(in) :: grid
    real (kind=float), optional, INTENT(in) :: initial
    ! Calls: Catch
end subroutine NewGridFloatAsGridInteger
</PRE>
 Description:
  create a new grid_real using an existing grid_integer as template
<A NAME="subroutine_newgridintegerasgridinteger"><H3>NewGridIntegerAsGridInteger</H3></A>
<PRE>private subroutine NewGridIntegerAsGridInteger (layer, grid, initial)
    type (grid_integer), INTENT(OUT) :: layer
</PRE>
<DL><DD><DL><DD>
grid to be returned
</DL></DL>
<PRE>    type (grid_integer), INTENT(IN) :: grid
    integer, optional, INTENT(IN) :: initial
    ! Calls: Catch
end subroutine NewGridIntegerAsGridInteger
</PRE>
 Description:
  create a new grid_integer using an existing grid_integer as template
<A NAME="subroutine_newgridintegerasgridfloat"><H3>NewGridIntegerAsGridFloat</H3></A>
<PRE>private subroutine NewGridIntegerAsGridFloat (layer, grid, initial)
    type (grid_integer), INTENT(OUT) :: layer
</PRE>
<DL><DD><DL><DD>
grid to be returned
</DL></DL>
<PRE>    type (grid_real), INTENT(in) :: grid
    integer, optional, INTENT(in) :: initial
    ! Calls: Catch
end subroutine NewGridIntegerAsGridFloat
</PRE>
 Description:
  create a new grid_integer using an existing grid_real as template
<A NAME="subroutine_setstandardnamefloat"><H3>SetStandardNameFloat</H3></A>
<PRE>private subroutine SetStandardNameFloat (name, layer)
    character (len=*), INTENT(IN) :: name
    type (grid_real), INTENT(INOUT) :: layer
end subroutine SetStandardNameFloat
</PRE>
 Description:
  set the standard name of a float grid
<A NAME="subroutine_setstandardnameinteger"><H3>SetStandardNameInteger</H3></A>
<PRE>private subroutine SetStandardNameInteger (name, layer)
    character (len=*), INTENT(IN) :: name
    type (grid_integer), INTENT(INOUT) :: layer
end subroutine SetStandardNameInteger
</PRE>
 Description:
  set the standard name of a integer grid
<A NAME="subroutine_setlongnamefloat"><H3>SetLongNameFloat</H3></A>
<PRE>private subroutine SetLongNameFloat (name, layer)
    character (len=*), INTENT(IN) :: name
    type (grid_real), INTENT(INOUT) :: layer
end subroutine SetLongNameFloat
</PRE>
 Description:
  set the long name of a float grid
<A NAME="subroutine_setlongnameinteger"><H3>SetLongNameInteger</H3></A>
<PRE>private subroutine SetLongNameInteger (name, layer)
    character (len=*), INTENT(IN) :: name
    type (grid_integer), INTENT(INOUT) :: layer
end subroutine SetLongNameInteger
</PRE>
 Description:
  set the long name of a integer grid
<A NAME="subroutine_setunitsfloat"><H3>SetUnitsFloat</H3></A>
<PRE>private subroutine SetUnitsFloat (units, layer)
    character (len=*), INTENT(IN) :: units
    type (grid_real), INTENT(INOUT) :: layer
end subroutine SetUnitsFloat
</PRE>
 Description:
  set the units of a float grid
<A NAME="subroutine_setunitsinteger"><H3>SetUnitsInteger</H3></A>
<PRE>private subroutine SetUnitsInteger (units, layer)
    character (len=*), INTENT(IN) :: units
    type (grid_integer), INTENT(INOUT) :: layer
end subroutine SetUnitsInteger
</PRE>
 Description:
  set the units of a integer grid
<A NAME="subroutine_setvaryingmodefloat"><H3>SetVaryingModeFloat</H3></A>
<PRE>private subroutine SetVaryingModeFloat (varMod, layer)
    character (len=*), INTENT(IN) :: varMod
    type (grid_real), INTENT(INOUT) :: layer
    ! Calls: Catch
end subroutine SetVaryingModeFloat
</PRE>
 Description:
  set the varying mode of a float grid
  Possible values:
  linear: linear variation between two dates
  sequence: new grid substitute the previous as frames in a movie
<A NAME="subroutine_setvaryingmodeinteger"><H3>SetVaryingModeInteger</H3></A>
<PRE>private subroutine SetVaryingModeInteger (varMod, layer)
    character (len=*), INTENT(IN) :: varMod
    type (grid_integer), INTENT(INOUT) :: layer
    ! Calls: Catch
end subroutine SetVaryingModeInteger
</PRE>
 Description:
  set the varying mode of a integer grid
<A NAME="subroutine_setreferencetimefloat"><H3>SetReferenceTimeFloat</H3></A>
<PRE>private subroutine SetReferenceTimeFloat (time, layer)
    type (DateTime), INTENT(IN) :: time
    type (grid_real), INTENT(INOUT) :: layer
end subroutine SetReferenceTimeFloat
</PRE>
 Description:
  set the reference time of a float grid
<A NAME="subroutine_setreferencetimeinteger"><H3>SetReferenceTimeInteger</H3></A>
<PRE>private subroutine SetReferenceTimeInteger (time, layer)
    type (DateTime), INTENT(IN) :: time
    type (grid_integer), INTENT(INOUT) :: layer
end subroutine SetReferenceTimeInteger
</PRE>
 Description:
  set the reference time of a integer grid
<A NAME="subroutine_setcurrenttimefloat"><H3>SetCurrentTimeFloat</H3></A>
<PRE>private subroutine SetCurrentTimeFloat (time, layer)
    type (DateTime), INTENT(IN) :: time
    type (grid_real), INTENT(INOUT) :: layer
end subroutine SetCurrentTimeFloat
</PRE>
 Description:
  set the current time of a float grid
<A NAME="subroutine_setcurrenttimeinteger"><H3>SetCurrentTimeInteger</H3></A>
<PRE>private subroutine SetCurrentTimeInteger (time, layer)
    type (DateTime), INTENT(IN) :: time
    type (grid_integer), INTENT(INOUT) :: layer
end subroutine SetCurrentTimeInteger
</PRE>
 Description:
  set the current time of a integer grid
<A NAME="subroutine_setesripestringfloat"><H3>SetEsriPeStringFloat</H3></A>
<PRE>private subroutine SetEsriPeStringFloat (string, layer)
    character (len=*), INTENT(IN) :: string
    type (grid_real), INTENT(INOUT) :: layer
end subroutine SetEsriPeStringFloat
</PRE>
 Description:
  set the esri pe string of a float grid
<A NAME="subroutine_setesripestringinteger"><H3>SetEsriPeStringInteger</H3></A>
<PRE>private subroutine SetEsriPeStringInteger (string, layer)
    character (len=*), INTENT(IN) :: string
    type (grid_integer), INTENT(INOUT) :: layer
end subroutine SetEsriPeStringInteger
</PRE>
 Description:
  set the esri pe string of a integer grid
<A NAME="subroutine_exportgridfloattonetcdf"><H3>ExportGridFloatToNetCDF</H3></A>
<PRE>private subroutine ExportGridFloatToNetCDF (grid, file, name, action)
    type (grid_real), INTENT(IN) :: grid
</PRE>
<DL><DD><DL><DD>
 grid to be exported
</DL></DL>
<PRE>    character (len=*), INTENT(IN) :: file
</PRE>
<DL><DD><DL><DD>
netcdf file to export to
</DL></DL>
<PRE>    character (len=*), INTENT(IN) :: name
</PRE>
<DL><DD><DL><DD>
name of variable in netcdf
</DL></DL>
<PRE>    character (len=*), INTENT(IN) :: action
</PRE>
<DL><DD><DL><DD>
add or append
</DL></DL>
<PRE>    ! Calls: Catch, ParseTime, SwapGridRealBack, ncErrorHandler
end subroutine ExportGridFloatToNetCDF
</PRE>
 Description:
  export grid into netcdf file. Two actions are possible:
  add: add a non-record variable to a netCDF dataset. If file does not exist
       it is created new. The added variable
       must have the same dimensions of already present variables.
       If you try to add a variable already present in netCDF dataset
       an error is returned.
  append: append more data to record variables along the unlimited dimension.
          If netCDF dataset is created new, dimensions and attributes
          are set, otherwise only new data are written. If current time
          is already present in netcdf dataset an error is returned
<A NAME="subroutine_exportgridintegertonetcdf"><H3>ExportGridIntegerToNetCDF</H3></A>
<PRE>public subroutine ExportGridIntegerToNetCDF (grid, file, name, action)
    type (grid_integer), INTENT(IN) :: grid
</PRE>
<DL><DD><DL><DD>
 grid to be exported
</DL></DL>
<PRE>    character (len=*), INTENT(IN) :: file
</PRE>
<DL><DD><DL><DD>
netcdf file to export to
</DL></DL>
<PRE>    character (len=*), INTENT(IN) :: name
</PRE>
<DL><DD><DL><DD>
name of variable in netcdf
</DL></DL>
<PRE>    character (len=*), INTENT(IN) :: action
</PRE>
<DL><DD><DL><DD>
add or append
</DL></DL>
<PRE>    ! Calls: Catch, ParseTime, SwapGridIntegerBack, ncErrorHandler
end subroutine ExportGridIntegerToNetCDF
</PRE>
 Description:
  export grid into netcdf file. Two actions are possible:
  add: add a non-record variable to a netCDF dataset. If file does not exist
       it is created new. The added variable
       must have the same dimensions of already present variables.
       If you try to add a variable already present in netCDF dataset
       an error is returned.
  append: append more data to record variables along the unlimited dimension.
          If netCDF dataset is created new, dimensions and attributes
          are set, otherwise only new data are written. If current time
          is already present in netcdf dataset an error is returned
<A NAME="subroutine_exportgridfloattofile"><H3>ExportGridFloatToFile</H3></A>
<PRE>private subroutine ExportGridFloatToFile (layer, fileName, fileFormat)
    type (grid_real), INTENT (IN) :: layer
    character (len=*), INTENT (IN) :: fileName
    integer (kind=short), INTENT(IN) :: fileFormat
    ! Calls: Catch, ExportGridFloatToESRI_ASCII, ExportGridFloatToESRI_BINARY
end subroutine ExportGridFloatToFile
</PRE>
 Description:
   export grid_real to file. 
   List of supported format:
   ESRI_ASCII: ESRI ASCII GRID
   ESRI_BINARY: ESRI BINARY GRID 
<A NAME="subroutine_exportgridfloattoesri_ascii"><H3>ExportGridFloatToESRI_ASCII</H3></A>
<PRE>private subroutine ExportGridFloatToESRI_ASCII (layer, fileName)
    type (grid_real), INTENT (IN) :: layer
    character (len=*), INTENT (IN) :: fileName
    ! Calls: Catch
end subroutine ExportGridFloatToESRI_ASCII
</PRE>
 Description:
   export grid_real to a ESRI ASCII file. 
<A NAME="subroutine_exportgridfloattoesri_binary"><H3>ExportGridFloatToESRI_BINARY</H3></A>
<PRE>private subroutine ExportGridFloatToESRI_BINARY (layer, fileName)
    type (grid_real), INTENT (IN) :: layer
    character (len=*), INTENT (IN) :: fileName
    ! Calls: Catch
end subroutine ExportGridFloatToESRI_BINARY
</PRE>
 Description:
   export grid_real to a ESRI BINARY file. 
<A NAME="subroutine_exportgridintegertofile"><H3>ExportGridIntegerToFile</H3></A>
<PRE>private subroutine ExportGridIntegerToFile (layer, fileName, fileFormat)
    type (grid_integer), INTENT (IN) :: layer
    character (len=*), INTENT (IN) :: fileName
    integer (kind=short), INTENT(IN) :: fileFormat
    ! Calls: Catch, ExportGridIntegerToESRI_ASCII, ExportGridIntegerToESRI_BINARY
end subroutine ExportGridIntegerToFile
</PRE>
 Description:
   export grid_integer to file. 
   List of supported format:
   ESRI_ASCII: ESRI ASCII GRID
   ESRI_BINARY: ESRI BINARY GRID 
<A NAME="subroutine_exportgridintegertoesri_ascii"><H3>ExportGridIntegerToESRI_ASCII</H3></A>
<PRE>private subroutine ExportGridIntegerToESRI_ASCII (layer, fileName)
    type (grid_integer), INTENT (IN) :: layer
    character (len=*), INTENT (IN) :: fileName
    ! Calls: Catch
end subroutine ExportGridIntegerToESRI_ASCII
</PRE>
 Description:
   export grid_integer to a ESRI ASCII file. 
<A NAME="subroutine_exportgridintegertoesri_binary"><H3>ExportGridIntegerToESRI_BINARY</H3></A>
<PRE>private subroutine ExportGridIntegerToESRI_BINARY (layer, fileName)
    type (grid_integer), INTENT (IN) :: layer
    character (len=*), INTENT (IN) :: fileName
    ! Calls: Catch
end subroutine ExportGridIntegerToESRI_BINARY
</PRE>
 Description:
   export grid_integer to a ESRI BINARY file. 
<A NAME="subroutine_getgeoreferencefromncdataset"><H3>GetGeoreferenceFromNCdataSet</H3></A>
<PRE>private subroutine GetGeoreferenceFromNCdataSet (ncId, varId, cellsize, xll, yll, grid_mapping)
    integer (kind=short), INTENT(IN) :: ncId
</PRE>
<DL><DD><DL><DD>
NetCdf Id for the file
</DL></DL>
<PRE>    integer (kind=short), INTENT(IN) :: varId
</PRE>
<DL><DD><DL><DD>
<PRE> ariable Id</PRE>
</DL></DL>
<PRE>    real (kind=float), INTENT(OUT) :: cellsize
</PRE>
<DL><DD><DL><DD>
cell resolution
</DL></DL>
<PRE>    real (kind=float), INTENT(OUT) :: xll
</PRE>
<DL><DD><DL><DD>
x  coordinate of lower left corner of map
</DL></DL>
<PRE>    real (kind=float), INTENT(OUT) :: yll
</PRE>
<DL><DD><DL><DD>
y  coordinate of lower left corner of map
</DL></DL>
<PRE>    type (CRS), INTENT(OUT) :: grid_mapping
</PRE>
<DL><DD><DL><DD>
coordinate reference system        
</DL></DL>
<PRE>    ! Calls: Catch, GetXYSizesFromFile, SetCRS, SetGeodeticParameters, SetTransverseMercatorParameters, ncErrorHandler
end subroutine GetGeoreferenceFromNCdataSet
</PRE>
 Description:
   read and calculate georeferencing informations from netCDF file.
<A NAME="subroutine_getxysizesfromfile"><H3>GetXYSizesFromFile</H3></A>
<PRE>private subroutine GetXYSizesFromFile (ncId, x, y, idx, idy, shape)
    integer (kind=short), INTENT(IN) :: ncId
</PRE>
<DL><DD><DL><DD>
NetCdf Id for the file
</DL></DL>
<PRE>    integer (kind=short), INTENT(OUT) :: x
</PRE>
<DL><DD><DL><DD>
number of columns and rows
</DL></DL>
<PRE>    integer (kind=short), INTENT(OUT) :: y
</PRE>
<DL><DD><DL><DD>
number of columns and rows
</DL></DL>
<PRE>    integer (kind=short), optional, INTENT(OUT) :: idx
</PRE>
<DL><DD><DL><DD>
 id of x variable
</DL></DL>
<PRE>    integer (kind=short), optional, INTENT(OUT) :: idy
</PRE>
<DL><DD><DL><DD>
 id of y variable
</DL></DL>
<PRE>    character (len=*), INTENT(OUT) :: shape
    ! Calls: ncErrorHandler
end subroutine GetXYSizesFromFile
</PRE>
 Description:
   extraxt the number of columns (x) and rows (y) from netCDF file.
<A NAME="function_timeindex"><H3>TimeIndex</H3></A>
<PRE>private function TimeIndex (ncId, refTime, timeUnit, time) result (index)
    integer (kind=short), INTENT(IN) :: ncId
</PRE>
<DL><DD><DL><DD>
NetCdf Id for the file
</DL></DL>
<PRE>    type (DateTime), INTENT(IN) :: refTime
</PRE>
<DL><DD><DL><DD>
reference time to calculate time index
</DL></DL>
<PRE>    character (len=*) :: timeUnit
    type (DateTime), INTENT (IN) :: time
</PRE>
<DL><DD><DL><DD>
time to calculate index from reference time
</DL></DL>
<PRE>    integer (kind=short) :: index
    ! Calls: Catch, ncErrorHandler
end function TimeIndex
</PRE>
 Description:
   Calculate the index to extract the corresponding slice from netcdf file.
<A NAME="function_nexttime"><H3>NextTime</H3></A>
<PRE>private function NextTime (ncId, refTime, timeUnit, current) result (time)
    integer (kind=short), INTENT(IN) :: ncId
</PRE>
<DL><DD><DL><DD>
NetCdf Id for the file
</DL></DL>
<PRE>    type (DateTime), INTENT(IN) :: refTime
</PRE>
<DL><DD><DL><DD>
reference time to calculate time index
</DL></DL>
<PRE>    character (len=*), INTENT(IN) :: timeUnit
    integer (kind=short), INTENT(IN) :: current
</PRE>
<DL><DD><DL><DD>
current time step
</DL></DL>
<PRE>    type (DateTime) :: time
</PRE>
<DL><DD><DL><DD>
returned time of the next grid
</DL></DL>
<PRE>    ! Calls: ncErrorHandler
end function NextTime
</PRE>
 Description
   returns the time of the next grid in netcdf dataset
<A NAME="subroutine_parsetime"><H3>ParseTime</H3></A>
<PRE>private subroutine ParseTime (ncId, ref_time, time_unit)
    integer (kind=short), INTENT(IN) :: ncId
</PRE>
<DL><DD><DL><DD>
NetCdf Id for the file
</DL></DL>
<PRE>    type (DateTime), INTENT(OUT) :: ref_time
    character (len=7), INTENT(OUT) :: time_unit
    ! Calls: ncErrorHandler
end subroutine ParseTime
</PRE>
 Description:
   Parse units attribute of time variable
 Limits:
   string representing date and time must not contain blanks
<A NAME="function_getgridmappingfloat"><H3>GetGridMappingFloat</H3></A>
<PRE>public function GetGridMappingFloat (layer) result (grid_mapping)
    type (grid_real), INTENT(INOUT) :: layer
    type (CRS) :: grid_mapping
end function GetGridMappingFloat
</PRE>
 Description:
   get grid mapping for a floating point grid
<A NAME="function_getgridmappinginteger"><H3>GetGridMappingInteger</H3></A>
<PRE>public function GetGridMappingInteger (layer) result (grid_mapping)
    type (grid_integer), INTENT(INOUT) :: layer
    type (CRS) :: grid_mapping
end function GetGridMappingInteger
</PRE>
 Description:
   get grid mapping for a floating point grid
<A NAME="subroutine_griddestroyfloat"><H3>GridDestroyFloat</H3></A>
<PRE>private subroutine GridDestroyFloat (layer)
    type (grid_real), INTENT(INOUT) :: layer
    ! Calls: Catch
end subroutine GridDestroyFloat
</PRE>
 Description:
   deallocate float grid
<A NAME="subroutine_griddestroyinteger"><H3>GridDestroyInteger</H3></A>
<PRE>private subroutine GridDestroyInteger (layer)
    type (grid_integer), INTENT(INOUT) :: layer
    ! Calls: Catch
end subroutine GridDestroyInteger
</PRE>
 Description:
   deallocate integer grid
<A NAME="subroutine_swapgridrealforward"><H3>SwapGridRealForward</H3></A>
<PRE>private subroutine SwapGridRealForward (matIn, matOut)
    real (kind=float), INTENT (IN), dimension (:,:) :: matIn
    real (kind=float), INTENT (OUT), dimension (:,:) :: matOut
end subroutine SwapGridRealForward
</PRE>
 Description:
   transport matrix from netcdf format to grid_real
<A NAME="subroutine_swapgridintegerforward"><H3>SwapGridIntegerForward</H3></A>
<PRE>private subroutine SwapGridIntegerForward (matIn, matOut)
    integer (kind=long), INTENT (IN), dimension (:,:) :: matIn
    integer (kind=long), INTENT (OUT), dimension (:,:) :: matOut
end subroutine SwapGridIntegerForward
</PRE>
 Description:
   transport matrix from netcdf format to grid_integer
<A NAME="subroutine_swapgridrealback"><H3>SwapGridRealBack</H3></A>
<PRE>private subroutine SwapGridRealBack (matIn, matOut)
    real (kind=float), INTENT (IN), dimension (:,:) :: matIn
    real (kind=float), INTENT (OUT), dimension (:,:) :: matOut
end subroutine SwapGridRealBack
</PRE>
 Description:
   transport matrix from grid_real to netcdf format
<A NAME="subroutine_swapgridintegerback"><H3>SwapGridIntegerBack</H3></A>
<PRE>private subroutine SwapGridIntegerBack (matIn, matOut)
    integer (kind=long), INTENT (IN), dimension (:,:) :: matIn
    integer (kind=long), INTENT (OUT), dimension (:,:) :: matOut
end subroutine SwapGridIntegerBack
</PRE>
 Description:
   transport matrix from grid_integer to netcdf format
<A NAME="subroutine_ncerrorhandler"><H3>ncErrorHandler</H3></A>
<PRE>public subroutine ncErrorHandler (errcode)
    integer (kind=short), INTENT (IN) :: errcode
    ! Calls: Catch
end subroutine ncErrorHandler
</PRE>
 Description:
   Handle errors from netcdf related operation
<A NAME="function_getdtgrid"><H3>GetDtGrid</H3></A>
<PRE>public function GetDtGrid (filename, checkRegular) result (dt)
    character (len=*), INTENT(IN) :: filename
    logical, optional, INTENT(IN) :: checkRegular
    integer (kind=long) :: dt
    ! Calls: Catch, ParseTime, ncErrorHandler
end function GetDtGrid
</PRE>
 Description:
  given filename of a multidimensional net-cdf file
  the GetDtGrid function returns the temporal resolution (seconds)
  assuming that it is regular
  If option checkRegular is true the function check that
  temporal resolution is regular
</HTML>
