<HTML>
<HEAD>
   <TITLE> module GeoLib (generated by f90doc) </TITLE>
</HEAD>
<H1> Module GeoLib </H1>
<PRE>module GeoLib

        ! Uses
    use <A HREF="loglib.html">LogLib</A>, ONLY : Catch
    use <A HREF="errorcodes.html">ErrorCodes</A>, ONLY : memAllocError, consistencyError, unknownOption
    use <A HREF="units.html">Units</A>, ONLY: degToRad, radToDeg

        ! Types
    public type <A HREF="geolib.html#type_ellipsoid">Ellipsoid</A>
    public type <A HREF="geolib.html#type_datum">datum</A>
    public type <A HREF="geolib.html#type_crs">CRS</A>
    public type <A HREF="geolib.html#type_coordinate">Coordinate</A>

        ! Variables
    integer, public, PARAMETER :: <A HREF="geolib.html#var_geodetic">GEODETIC</A> = 1
    integer, public, PARAMETER :: <A HREF="geolib.html#var_utm">UTM</A> = 2
    integer, public, PARAMETER :: <A HREF="geolib.html#var_gauss_boaga">GAUSS_BOAGA</A> = 3
    integer, public, PARAMETER :: <A HREF="geolib.html#var_tm">TM</A> = 4
    integer, public, PARAMETER :: <A HREF="geolib.html#var_hom">HOM</A> = 5
    integer, public, PARAMETER :: <A HREF="geolib.html#var_soc">SOC</A> = 6
    integer, public, PARAMETER :: <A HREF="geolib.html#var_wgs84">WGS84</A> = 6326
    integer, public, PARAMETER :: <A HREF="geolib.html#var_ed50">ED50</A> = 6230
    integer, public, PARAMETER :: <A HREF="geolib.html#var_rome40">ROME40</A> = 6265
    integer, public, PARAMETER :: <A HREF="geolib.html#var_ch1903">CH1903</A> = 6149
    integer, public, PARAMETER :: <A HREF="geolib.html#var_north">NORTH</A> = 1
    integer, public, PARAMETER :: <A HREF="geolib.html#var_south">SOUTH</A> = 2
    integer, public, PARAMETER :: <A HREF="geolib.html#var_east">EAST</A> = 3
    integer, public, PARAMETER :: <A HREF="geolib.html#var_west">WEST</A> = 4
    type (Coordinate), public :: <A HREF="geolib.html#var_point1">point1</A>
    type (Coordinate), public :: <A HREF="geolib.html#var_point2">point2</A>
    integer, private, PARAMETER :: <A HREF="geolib.html#var_utm_lat0">UTM_lat0</A> = 1
    integer, private, PARAMETER :: <A HREF="geolib.html#var_utm_centm">UTM_centM</A> = 2
    integer, private, PARAMETER :: <A HREF="geolib.html#var_utm_zone">UTM_zone</A> = 3
    integer, private, PARAMETER :: <A HREF="geolib.html#var_utm_hemisphere">UTM_hemisphere</A> = 4
    integer, private, PARAMETER :: <A HREF="geolib.html#var_utm_false_easting">UTM_false_easting</A> = 5
    integer, private, PARAMETER :: <A HREF="geolib.html#var_utm_false_northing">UTM_false_northing</A> = 6
    integer, private, PARAMETER :: <A HREF="geolib.html#var_utm_scale_factor">UTM_scale_factor</A> = 7
    integer, private, PARAMETER :: <A HREF="geolib.html#var_utm_override">UTM_override</A> = 8
    integer, private, PARAMETER :: <A HREF="geolib.html#var_tm_lat0">TM_lat0</A> = 1
    integer, private, PARAMETER :: <A HREF="geolib.html#var_tm_centm">TM_centM</A> = 2
    integer, private, PARAMETER :: <A HREF="geolib.html#var_tm_false_easting">TM_false_easting</A> = 3
    integer, private, PARAMETER :: <A HREF="geolib.html#var_tm_false_northing">TM_false_northing</A> = 4
    integer, private, PARAMETER :: <A HREF="geolib.html#var_tm_scale_factor">TM_scale_factor</A> = 5
    integer, private, PARAMETER :: <A HREF="geolib.html#var_gb_lat0">GB_lat0</A> = 1
    integer, private, PARAMETER :: <A HREF="geolib.html#var_gb_centm">GB_centM</A> = 2
    integer, private, PARAMETER :: <A HREF="geolib.html#var_gb_fuse">GB_fuse</A> = 3
    integer, private, PARAMETER :: <A HREF="geolib.html#var_gb_false_easting">GB_false_easting</A> = 4
    integer, private, PARAMETER :: <A HREF="geolib.html#var_gb_false_northing">GB_false_northing</A> = 5
    integer, private, PARAMETER :: <A HREF="geolib.html#var_gb_scale_factor">GB_scale_factor</A> = 6
    integer, private, PARAMETER :: <A HREF="geolib.html#var_gb_override">GB_override</A> = 7
    integer, private, PARAMETER :: <A HREF="geolib.html#var_geo_a">GEO_a</A> = 1
    integer, private, PARAMETER :: <A HREF="geolib.html#var_geo_b">GEO_b</A> = 2
    integer, private, PARAMETER :: <A HREF="geolib.html#var_geo_invf">GEO_invf</A> = 3
    integer, private, PARAMETER :: <A HREF="geolib.html#var_geo_prime">GEO_prime</A> = 4
    integer, private, PARAMETER :: <A HREF="geolib.html#var_hom_lat0">HOM_lat0</A> = 1
    integer, private, PARAMETER :: <A HREF="geolib.html#var_hom_centm">HOM_centM</A> = 2
    integer, private, PARAMETER :: <A HREF="geolib.html#var_hom_azimuth">HOM_azimuth</A> = 3
    integer, private, PARAMETER :: <A HREF="geolib.html#var_hom_false_easting">HOM_false_easting</A> = 4
    integer, private, PARAMETER :: <A HREF="geolib.html#var_hom_false_northing">HOM_false_northing</A> = 5
    integer, private, PARAMETER :: <A HREF="geolib.html#var_hom_scale_factor">HOM_scale_factor</A> = 6
    integer, private, PARAMETER :: <A HREF="geolib.html#var_soc_latc">SOC_latc</A> = 1
    integer, private, PARAMETER :: <A HREF="geolib.html#var_soc_lonc">SOC_lonc</A> = 2
    integer, private, PARAMETER :: <A HREF="geolib.html#var_soc_azimuth">SOC_azimuth</A> = 3
    integer, private, PARAMETER :: <A HREF="geolib.html#var_soc_false_easting">SOC_false_easting</A> = 4
    integer, private, PARAMETER :: <A HREF="geolib.html#var_soc_false_northing">SOC_false_northing</A> = 5
    integer, private, PARAMETER :: <A HREF="geolib.html#var_soc_scale_factor">SOC_scale_factor</A> = 6
    type (Ellipsoid), private, ALLOCATABLE, dimension  (:) :: <A HREF="geolib.html#var_ellps">ellps</A>
    type (Datum), private, ALLOCATABLE, dimension  (:) :: <A HREF="geolib.html#var_datums">datums</A>
    real (kind=Float), private, PARAMETER :: <A HREF="geolib.html#var_null_float">null_float</A> = -9999.9
    character (len=0), private, PARAMETER :: <A HREF="geolib.html#var_null_string">null_string</A> = ''

        ! Interfaces
    public interface <A HREF="geolib.html#interface_operator (==)">OPERATOR (==)</A>
    public interface <A HREF="geolib.html#interface_assignment( = )">ASSIGNMENT( = )</A>
    public interface <A HREF="geolib.html#interface_setcrs">SetCRS</A>
    public interface <A HREF="geolib.html#interface_setgeodeticparameters">SetGeodeticParameters</A>
    public interface <A HREF="geolib.html#interface_setutmparameters">SetUTMparameters</A>
    public interface <A HREF="geolib.html#interface_settransversemercatorparameters">SetTransverseMercatorParameters</A>
    public interface <A HREF="geolib.html#interface_setgaussboagaparameters">SetGaussBoagaParameters</A>
    public interface <A HREF="geolib.html#interface_sethotineparameters">SetHotineParameters</A>
    public interface <A HREF="geolib.html#interface_setswissparameters">SetSwissParameters</A>

        ! Subroutines and functions
    public subroutine <A HREF="geolib.html#subroutine_convert">Convert</A> (input, output)
    public subroutine <A HREF="geolib.html#subroutine_geoinit">GeoInit</A> (file)
    private subroutine <A HREF="geolib.html#subroutine_setcrscoord">SetCRScoord</A> (CRStype, datumType, coord)
    private subroutine <A HREF="geolib.html#subroutine_setcrssystem">SetCRSsystem</A> (CRStype, datumType, rs)
    private subroutine <A HREF="geolib.html#subroutine_copycrs">CopyCRS</A> (CRSout, CRSin)
    public subroutine <A HREF="geolib.html#subroutine_setcoord">SetCoord</A> (x, y, coord)
    private subroutine <A HREF="geolib.html#subroutine_copyellipsoid">CopyEllipsoid</A> (ell2, ell1)
    private subroutine <A HREF="geolib.html#subroutine_searchellipsoidbycode">SearchEllipsoidByCode</A> (ell, code)
    private subroutine <A HREF="geolib.html#subroutine_copydatum">CopyDatum</A> (datum2, datum1)
    private subroutine <A HREF="geolib.html#subroutine_searchdatumbycode">SearchDatumByCode</A> (dat, code)
    private subroutine <A HREF="geolib.html#subroutine_setgeodeticparameterssystem">SetGeodeticParametersSystem</A> (system, prime_meridian)
    private subroutine <A HREF="geolib.html#subroutine_setgeodeticparameterscoord">SetGeodeticParametersCoord</A> (coord, prime_meridian)
    private subroutine <A HREF="geolib.html#subroutine_settransversemercatorparameterssystem">SetTransverseMercatorParametersSystem</A> (system, lat0, centM, falseE, falseN, k)
    private subroutine <A HREF="geolib.html#subroutine_settransversemercatorparameterscoord">SetTransverseMercatorParametersCoord</A> (coord, lat0, centM, falseE, falseN, k)
    private subroutine <A HREF="geolib.html#subroutine_setutmparameterssystem">SetUTMparametersSystem</A> (system, zone, hemisphere, override)
    private subroutine <A HREF="geolib.html#subroutine_setutmparameterscoord">SetUTMparametersCoord</A> (coord, zone, hemisphere, override)
    private subroutine <A HREF="geolib.html#subroutine_converttransversemercatortogeodetic">ConvertTransverseMercatorToGeodetic</A> (x, y, k, centM, lat0, a, e, eb, falseN, falseE, lon, lat)
    private subroutine <A HREF="geolib.html#subroutine_convertgeodetictotransversemercator">ConvertGeodeticToTransverseMercator</A> (lon, lat, k, centM, lat0, a, e, eb, falseN, falseE, x, y)
    private subroutine <A HREF="geolib.html#subroutine_convertutmtogeodetic">ConvertUTMtoGeodetic</A> (x, y, k, centM, lat0, a, e, eb, falseN, falseE, override, lon, lat)
    private subroutine <A HREF="geolib.html#subroutine_convertgeodetictoutm">ConvertGeodeticToUTM</A> (lon, lat, k, centM, lat0, a, e, eb, falseN, falseE, x, y, zone, hemisphere, override)
    private subroutine <A HREF="geolib.html#subroutine_setgaussboagaparameterssystem">SetGaussBoagaparametersSystem</A> (system, fuse, override)
    private subroutine <A HREF="geolib.html#subroutine_setgaussboagaparameterscoord">SetGaussBoagaparametersCoord</A> (coord, fuse, override)
    private subroutine <A HREF="geolib.html#subroutine_convertgaussboagatogeodetic">ConvertGaussBoagaToGeodetic</A> (x, y, k, centM, lat0, a, e, eb, falseN, falseE, lon, lat)
    private subroutine <A HREF="geolib.html#subroutine_convertgeodetictogaussboaga">ConvertGeodeticToGaussBoaga</A> (lon, lat, k, centM, lat0, a, e, eb, falseN, falseE, x, y)
    private subroutine <A HREF="geolib.html#subroutine_sethotineparameterssystem">SetHotineParametersSystem</A> (system, lat0, centM, azimuth, falseE, falseN, k)
    private subroutine <A HREF="geolib.html#subroutine_sethotineparameterscoord">SetHotineParametersCoord</A> (coord, lat0, centM, azimuth, falseE, falseN, k)
    private subroutine <A HREF="geolib.html#subroutine_converthotinetogeodetic">ConvertHotineToGeodetic</A> (x, y, k, lon0, lat0, azimuth, a, e, falseN, falseE, lon, lat)
    private subroutine <A HREF="geolib.html#subroutine_convertgeodetictohotine">ConvertGeodeticToHotine</A> (lon, lat, k, lon0, lat0, azimuth, a, e, falseN, falseE, x, y)
    private subroutine <A HREF="geolib.html#subroutine_setswissparameterssystem">SetSwissParametersSystem</A> (system, latc, lonc, azimuth, falseE, falseN, k)
    private subroutine <A HREF="geolib.html#subroutine_setswissparameterscoord">SetSwissParametersCoord</A> (coord, latc, lonc, azimuth, falseE, falseN, k)
    private subroutine <A HREF="geolib.html#subroutine_convertswisstogeodetic">ConvertSwissToGeodetic</A> (x, y, k, lon0, lat0, azimuth, a, e, falseN, falseE, lon, lat)
    public subroutine <A HREF="geolib.html#subroutine_convertgeodetictoswiss">ConvertGeodeticToSwiss</A> (lon, lat, k, lon0, lat0, azimuth, a, e, falseN, falseE, x, y)
    private function <A HREF="geolib.html#function_rho">Rho</A> (lat, a, e) result (radius)
    private function <A HREF="geolib.html#function_nu">Nu</A> (lat, a, e) result (radius)
    private function <A HREF="geolib.html#function_meridionaldistance">MeridionalDistance</A> (lat, a, e) result (M)
    private subroutine <A HREF="geolib.html#subroutine_geodeticshifttowgs84">GeodeticShiftToWGS84</A> (input, latIn, lonIn, WGS84lat, WGS84lon)
    private subroutine <A HREF="geolib.html#subroutine_geodeticshiftfromwgs84">GeodeticShiftFromWGS84</A> (input, WGS84lat, WGS84lon, latOut, lonOut)
    private subroutine <A HREF="geolib.html#subroutine_molodenskyshift">MolodenskyShift</A> (a, da, f, df, dx, dy, dz, Lat_in, Lon_in, Hgt_in, WGS84_Lat, WGS84_Lon, WGS84_Hgt)
    private function <A HREF="geolib.html#function_crsisequal">CRSisEqual</A> (CRS1, CRS2) result (isEqual)
    private function <A HREF="geolib.html#function_ellipsoidisequal">EllipsoidIsEqual</A> (ellps1, ellps2) result (isEqual)
    private function <A HREF="geolib.html#function_datumisequal">DatumIsEqual</A> (datum1, datum2) result (isEqual)
    public function <A HREF="geolib.html#function_scandatum">ScanDatum</A> (datumString) result (datumCode)
    public function <A HREF="geolib.html#function_distance">Distance</A> (point1, point2)

end module GeoLib
</PRE>
 This file is part of 
<P>
 MOSAICO -- MOdular library for raSter bAsed hydrologIcal appliCatiOn.
<P>
   Copyright (C) 2011 Giovanni Ravazzani
<P>
   This program is free software: you can redistribute it and/or modify
   it under the terms of the GNU General Public License as published by
   the Free Software Foundation, either version 3 of the License, or
   (at your option) any later version.
<P>
   This program is distributed in the hope that it will be useful,
   but WITHOUT ANY WARRANTY; without even the implied warranty of
   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
   GNU General Public License for more details.
<P>
   You should have received a copy of the GNU General Public License
   along with this program.  If not, see <http://www.gnu.org/licenses/>.
 Module Description: 
   set of fortran routines that allows you to convert geographic 
   coordinates among a variety of coordinate systems, 
   map projections, and datums.  
   The function Convert is the heart of the GeoLib module.
   It is this function that actually performs all coordinate conversions 
   and datum shifts.  Given the input and output datums, the input and 
   output coordinate reference system, including the values of any 
   projection parameters, and the input coordinates, it produces 
   the output coordinates.
 Methods:
   The general case is handled in three stages:
   1. Convert the input coordinates from the input coordinate reference 
      system to geodetic,
   2. Shift the intermediate geodetic coordinates from the input datum 
      to the output datum, converting between ellipsoid if necessary,
   3. Convert the shifted intermediate geodetic coordinates to the 
      output coordinate reference system.
   The first stage is accomplished by a case statement on the input 
   coordinate reference system, with a case for each of the coordinate 
   reference systems supported.  If the input coordinates are already 
   in geodetic, they are simply copied to the intermediate coordinates.
   The second stage is accomplished in two steps.  First, the intermediate 
   Geodetic coordinates are shifted to WGS 84, if necessary. Second, 
   the shifted intermediate geodetic coordinates are shifted to 
   the output datum.
   The third stage is similar to the first stage.  A case statement 
   on the output coordinate reference system, with a case for each 
   of the coordinate reference frames supported, is used to convert 
   the shifted intermediate Geodetic coordinates to the output coordinate 
   reference system.  If the output coordinate reference system is Geodetic, 
   the shifted intermediate coordinates are simply copied to the output
   coordinates.
 References:
   GeoTrans: http://earth-info.nga.mil/GandG/geotrans/index.html
   European Petroleum Survey Group (EPSG): http://www.epsg.org
   http://spatialreference.org/
   http://www.borneo.name/topo/roma40.html
<P>
<STRONG>Author:</STRONG> <a href="mailto:giovanni.ravazzani@polimi.it">Giovanni Ravazzani</a>
<P>
<STRONG>Version:</STRONG> 0.6 - 3rd February 2011

<HR><H2> Description of Types </H2>
<A NAME="type_ellipsoid"><H3>Ellipsoid</H3></A>
<PRE>public type Ellipsoid
    character (len=100) :: name
    integer (kind=short) :: code
</PRE>
<DL><DD><DL><DD>
EPSG code
</DL></DL>
<PRE>    character (len=100) :: epsg
</PRE>
<DL><DD><DL><DD>
EPSG string
</DL></DL>
<PRE>    real (kind=Float) :: a
</PRE>
<DL><DD><DL><DD>
semi-major axis
</DL></DL>
<PRE>    real (kind=Float) :: b
</PRE>
<DL><DD><DL><DD>
semi-minor axis
</DL></DL>
<PRE>    real (kind=Float) :: inv_f
</PRE>
<DL><DD><DL><DD>
a/(a-b)
</DL></DL>
<PRE>    real (kind=Float) :: e
</PRE>
<DL><DD><DL><DD>
eccentricity
</DL></DL>
<PRE>    real (kind=Float) :: f
</PRE>
<DL><DD><DL><DD>
flattening
</DL></DL>
<PRE>    real (kind=Float) :: e_second
</PRE>
<DL><DD><DL><DD>
second eccentricity
</DL></DL>
<PRE>end type Ellipsoid
</PRE>
<A NAME="type_datum"><H3>datum</H3></A>
<PRE>public type datum
    character (len=100) :: name
    integer (kind=short) :: code
    integer (kind=short) :: ellipsoid
</PRE>
<DL><DD><DL><DD>
reference ellipsoid code
</DL></DL>
<PRE>    integer (kind=short) :: prime_meridian
</PRE>
<DL><DD><DL><DD>
EPSG code defining prime meridian
</DL></DL>
<PRE>    integer (kind=short) :: method
</PRE>
<DL><DD><DL><DD>
EPSG code defining operation method for translation to WGS84
</DL></DL>
<PRE>    real (kind=Float) :: dx
</PRE>
<DL><DD><DL><DD>
entity of x-axis translation
</DL></DL>
<PRE>    real (kind=Float) :: dy
</PRE>
<DL><DD><DL><DD>
entity of y-axis translation
</DL></DL>
<PRE>    real (kind=Float) :: dz
</PRE>
<DL><DD><DL><DD>
entity of z-axis translation
</DL></DL>
<PRE>    character (len=100) :: epsg
</PRE>
<DL><DD><DL><DD>
EPSG string
</DL></DL>
<PRE>end type datum
</PRE>
<A NAME="type_crs"><H3>CRS</H3></A>
<PRE>public type CRS
    integer :: system
</PRE>
<DL><DD><DL><DD>
 geodetic, UTM, Gaus  Boaga, etc.. 
</DL></DL>
<PRE>    character (len=50) :: name
</PRE>
<DL><DD><DL><DD>
name of CRS
</DL></DL>
<PRE>    type (ellipsoid) :: ellipsoid
    type (datum) :: datum
    integer (kind=short) :: basic
</PRE>
<DL><DD><DL><DD>
 number of basic parameters for the reference system
</DL></DL>
<PRE>    real (kind=FLOAT), ALLOCATABLE, dimension  (:) :: param
</PRE>
<DL><DD><DL><DD>
required parameters for the definition of reference system
</DL></DL>
<PRE>    character (len=100), ALLOCATABLE, dimension  (:) :: description
</PRE>
<DL><DD><DL><DD>
description of the parameter (eg. zone for UTM, etc..)
</DL></DL>
<PRE>end type CRS
</PRE>
coordinate reference system
<A NAME="type_coordinate"><H3>Coordinate</H3></A>
<PRE>public type Coordinate
    real (kind=Float) :: easting
</PRE>
<DL><DD><DL><DD>
X coordinate, longitude
</DL></DL>
<PRE>    real (kind=Float) :: northing
</PRE>
<DL><DD><DL><DD>
Y coordinate, latitude
</DL></DL>
<PRE>    type (CRS) :: system
</PRE>
<DL><DD><DL><DD>
coordinate reference system
</DL></DL>
<PRE>end type Coordinate
</PRE>

<HR><H2> Description of Variables </H2>
<A NAME="var_geodetic"><H3>GEODETIC</H3></A>
<PRE>integer, public, PARAMETER :: GEODETIC = 1
</PRE>
Coordinate Reference Systems
<A NAME="var_utm"><H3>UTM</H3></A>
<PRE>integer, public, PARAMETER :: UTM = 2
</PRE>
Coordinate Reference Systems
<A NAME="var_gauss_boaga"><H3>GAUSS_BOAGA</H3></A>
<PRE>integer, public, PARAMETER :: GAUSS_BOAGA = 3
</PRE>
Coordinate Reference Systems
<A NAME="var_tm"><H3>TM</H3></A>
<PRE>integer, public, PARAMETER :: TM = 4
</PRE>
Coordinate Reference Systems
<A NAME="var_hom"><H3>HOM</H3></A>
<PRE>integer, public, PARAMETER :: HOM = 5
</PRE>
Coordinate Reference Systems
<A NAME="var_soc"><H3>SOC</H3></A>
<PRE>integer, public, PARAMETER :: SOC = 6
</PRE>
Coordinate Reference Systems
<A NAME="var_wgs84"><H3>WGS84</H3></A>
<PRE>integer, public, PARAMETER :: WGS84 = 6326
</PRE>
Datums
World Geodetic System 1984
European Datum 1950
Monte Mario Italy
Switzerland 
<A NAME="var_ed50"><H3>ED50</H3></A>
<PRE>integer, public, PARAMETER :: ED50 = 6230
</PRE>
Datums
World Geodetic System 1984
European Datum 1950
Monte Mario Italy
Switzerland 
<A NAME="var_rome40"><H3>ROME40</H3></A>
<PRE>integer, public, PARAMETER :: ROME40 = 6265
</PRE>
Datums
World Geodetic System 1984
European Datum 1950
Monte Mario Italy
Switzerland 
<A NAME="var_ch1903"><H3>CH1903</H3></A>
<PRE>integer, public, PARAMETER :: CH1903 = 6149
</PRE>
Datums
World Geodetic System 1984
European Datum 1950
Monte Mario Italy
Switzerland 
<A NAME="var_north"><H3>NORTH</H3></A>
<PRE>integer, public, PARAMETER :: NORTH = 1
</PRE>
general
<A NAME="var_south"><H3>SOUTH</H3></A>
<PRE>integer, public, PARAMETER :: SOUTH = 2
</PRE>
general
<A NAME="var_east"><H3>EAST</H3></A>
<PRE>integer, public, PARAMETER :: EAST = 3
</PRE>
general
<A NAME="var_west"><H3>WEST</H3></A>
<PRE>integer, public, PARAMETER :: WEST = 4
</PRE>
general
<A NAME="var_point1"><H3>point1</H3></A>
<PRE>type (Coordinate), public :: point1
</PRE>
can be used to calculate distance between two pints
<A NAME="var_point2"><H3>point2</H3></A>
<PRE>type (Coordinate), public :: point2
</PRE>
can be used to calculate distance between two pints
<A NAME="var_utm_lat0"><H3>UTM_lat0</H3></A>
<PRE>integer, private, PARAMETER :: UTM_lat0 = 1
</PRE>
Zone override flag
Zone override flag
<A NAME="var_utm_centm"><H3>UTM_centM</H3></A>
<PRE>integer, private, PARAMETER :: UTM_centM = 2
</PRE>
Zone override flag
Zone override flag
<A NAME="var_utm_zone"><H3>UTM_zone</H3></A>
<PRE>integer, private, PARAMETER :: UTM_zone = 3
</PRE>
Zone override flag
Zone override flag
<A NAME="var_utm_hemisphere"><H3>UTM_hemisphere</H3></A>
<PRE>integer, private, PARAMETER :: UTM_hemisphere = 4
</PRE>
Zone override flag
Zone override flag
<A NAME="var_utm_false_easting"><H3>UTM_false_easting</H3></A>
<PRE>integer, private, PARAMETER :: UTM_false_easting = 5
</PRE>
Zone override flag
Zone override flag
<A NAME="var_utm_false_northing"><H3>UTM_false_northing</H3></A>
<PRE>integer, private, PARAMETER :: UTM_false_northing = 6
</PRE>
Zone override flag
Zone override flag
<A NAME="var_utm_scale_factor"><H3>UTM_scale_factor</H3></A>
<PRE>integer, private, PARAMETER :: UTM_scale_factor = 7
</PRE>
Zone override flag
Zone override flag
<A NAME="var_utm_override"><H3>UTM_override</H3></A>
<PRE>integer, private, PARAMETER :: UTM_override = 8
</PRE>
Zone override flag
Zone override flag
<A NAME="var_tm_lat0"><H3>TM_lat0</H3></A>
<PRE>integer, private, PARAMETER :: TM_lat0 = 1
</PRE>
Zone override flag
Zone override flag
<A NAME="var_tm_centm"><H3>TM_centM</H3></A>
<PRE>integer, private, PARAMETER :: TM_centM = 2
</PRE>
Zone override flag
Zone override flag
<A NAME="var_tm_false_easting"><H3>TM_false_easting</H3></A>
<PRE>integer, private, PARAMETER :: TM_false_easting = 3
</PRE>
Zone override flag
Zone override flag
<A NAME="var_tm_false_northing"><H3>TM_false_northing</H3></A>
<PRE>integer, private, PARAMETER :: TM_false_northing = 4
</PRE>
Zone override flag
Zone override flag
<A NAME="var_tm_scale_factor"><H3>TM_scale_factor</H3></A>
<PRE>integer, private, PARAMETER :: TM_scale_factor = 5
</PRE>
Zone override flag
Zone override flag
<A NAME="var_gb_lat0"><H3>GB_lat0</H3></A>
<PRE>integer, private, PARAMETER :: GB_lat0 = 1
</PRE>
Zone override flag
Zone override flag
<A NAME="var_gb_centm"><H3>GB_centM</H3></A>
<PRE>integer, private, PARAMETER :: GB_centM = 2
</PRE>
Zone override flag
Zone override flag
<A NAME="var_gb_fuse"><H3>GB_fuse</H3></A>
<PRE>integer, private, PARAMETER :: GB_fuse = 3
</PRE>
Zone override flag
Zone override flag
<A NAME="var_gb_false_easting"><H3>GB_false_easting</H3></A>
<PRE>integer, private, PARAMETER :: GB_false_easting = 4
</PRE>
Zone override flag
Zone override flag
<A NAME="var_gb_false_northing"><H3>GB_false_northing</H3></A>
<PRE>integer, private, PARAMETER :: GB_false_northing = 5
</PRE>
Zone override flag
Zone override flag
<A NAME="var_gb_scale_factor"><H3>GB_scale_factor</H3></A>
<PRE>integer, private, PARAMETER :: GB_scale_factor = 6
</PRE>
Zone override flag
Zone override flag
<A NAME="var_gb_override"><H3>GB_override</H3></A>
<PRE>integer, private, PARAMETER :: GB_override = 7
</PRE>
Zone override flag
Zone override flag
<A NAME="var_geo_a"><H3>GEO_a</H3></A>
<PRE>integer, private, PARAMETER :: GEO_a = 1
</PRE>
Zone override flag
Zone override flag
<A NAME="var_geo_b"><H3>GEO_b</H3></A>
<PRE>integer, private, PARAMETER :: GEO_b = 2
</PRE>
Zone override flag
Zone override flag
<A NAME="var_geo_invf"><H3>GEO_invf</H3></A>
<PRE>integer, private, PARAMETER :: GEO_invf = 3
</PRE>
Zone override flag
Zone override flag
<A NAME="var_geo_prime"><H3>GEO_prime</H3></A>
<PRE>integer, private, PARAMETER :: GEO_prime = 4
</PRE>
Zone override flag
Zone override flag
<A NAME="var_hom_lat0"><H3>HOM_lat0</H3></A>
<PRE>integer, private, PARAMETER :: HOM_lat0 = 1
</PRE>
Zone override flag
Zone override flag
<A NAME="var_hom_centm"><H3>HOM_centM</H3></A>
<PRE>integer, private, PARAMETER :: HOM_centM = 2
</PRE>
Zone override flag
Zone override flag
<A NAME="var_hom_azimuth"><H3>HOM_azimuth</H3></A>
<PRE>integer, private, PARAMETER :: HOM_azimuth = 3
</PRE>
Zone override flag
Zone override flag
<A NAME="var_hom_false_easting"><H3>HOM_false_easting</H3></A>
<PRE>integer, private, PARAMETER :: HOM_false_easting = 4
</PRE>
Zone override flag
Zone override flag
<A NAME="var_hom_false_northing"><H3>HOM_false_northing</H3></A>
<PRE>integer, private, PARAMETER :: HOM_false_northing = 5
</PRE>
Zone override flag
Zone override flag
<A NAME="var_hom_scale_factor"><H3>HOM_scale_factor</H3></A>
<PRE>integer, private, PARAMETER :: HOM_scale_factor = 6
</PRE>
Zone override flag
Zone override flag
<A NAME="var_soc_latc"><H3>SOC_latc</H3></A>
<PRE>integer, private, PARAMETER :: SOC_latc = 1
</PRE>
Zone override flag
Zone override flag
<A NAME="var_soc_lonc"><H3>SOC_lonc</H3></A>
<PRE>integer, private, PARAMETER :: SOC_lonc = 2
</PRE>
Zone override flag
Zone override flag
<A NAME="var_soc_azimuth"><H3>SOC_azimuth</H3></A>
<PRE>integer, private, PARAMETER :: SOC_azimuth = 3
</PRE>
Zone override flag
Zone override flag
<A NAME="var_soc_false_easting"><H3>SOC_false_easting</H3></A>
<PRE>integer, private, PARAMETER :: SOC_false_easting = 4
</PRE>
Zone override flag
Zone override flag
<A NAME="var_soc_false_northing"><H3>SOC_false_northing</H3></A>
<PRE>integer, private, PARAMETER :: SOC_false_northing = 5
</PRE>
Zone override flag
Zone override flag
<A NAME="var_soc_scale_factor"><H3>SOC_scale_factor</H3></A>
<PRE>integer, private, PARAMETER :: SOC_scale_factor = 6
</PRE>
Zone override flag
Zone override flag
<A NAME="var_ellps"><H3>ellps</H3></A>
<PRE>type (Ellipsoid), private, ALLOCATABLE, dimension  (:) :: ellps
</PRE>
array of available ellipsoids
<A NAME="var_datums"><H3>datums</H3></A>
<PRE>type (Datum), private, ALLOCATABLE, dimension  (:) :: datums
</PRE>
array of available datums
<A NAME="var_null_float"><H3>null_float</H3></A>
<PRE>real (kind=Float), private, PARAMETER :: null_float = -9999.9
</PRE>
<A NAME="var_null_string"><H3>null_string</H3></A>
<PRE>character (len=0), private, PARAMETER :: null_string = ''
</PRE>

<HR><H2> Description of Interfaces </H2>
<A NAME="interface_operator (==)"><H3>OPERATOR (==)</H3></A>
<PRE>public interface OPERATOR (==)
    module procedure <A HREF="#function_crsisequal">CRSisEqual</A>
    module procedure <A HREF="#function_ellipsoidisequal">EllipsoidIsEqual</A>
    module procedure <A HREF="#function_datumisequal">DatumIsEqual</A>
end interface OPERATOR (==)
</PRE>
<A NAME="interface_assignment( = )"><H3>ASSIGNMENT( = )</H3></A>
<PRE>public interface ASSIGNMENT( = )
    module procedure <A HREF="#subroutine_copyellipsoid">CopyEllipsoid</A>
    module procedure <A HREF="#subroutine_searchellipsoidbycode">SearchEllipsoidByCode</A>
    module procedure <A HREF="#subroutine_copydatum">CopyDatum</A>
    module procedure <A HREF="#subroutine_searchdatumbycode">SearchDatumByCode</A>
    module procedure <A HREF="#subroutine_copycrs">CopyCRS</A>
end interface ASSIGNMENT( = )
</PRE>
<A NAME="interface_setcrs"><H3>SetCRS</H3></A>
<PRE>public interface SetCRS
    module procedure <A HREF="#subroutine_setcrscoord">SetCRScoord</A>
    module procedure <A HREF="#subroutine_setcrssystem">SetCRSsystem</A>
end interface SetCRS
</PRE>
<A NAME="interface_setgeodeticparameters"><H3>SetGeodeticParameters</H3></A>
<PRE>public interface SetGeodeticParameters
    module procedure <A HREF="#subroutine_setgeodeticparameterssystem">SetGeodeticParametersSystem</A>
    module procedure <A HREF="#subroutine_setgeodeticparameterscoord">SetGeodeticParametersCoord</A>
end interface SetGeodeticParameters
</PRE>
<A NAME="interface_setutmparameters"><H3>SetUTMparameters</H3></A>
<PRE>public interface SetUTMparameters
    module procedure <A HREF="#subroutine_setutmparameterssystem">SetUTMparametersSystem</A>
    module procedure <A HREF="#subroutine_setutmparameterscoord">SetUTMparametersCoord</A>
end interface SetUTMparameters
</PRE>
<A NAME="interface_settransversemercatorparameters"><H3>SetTransverseMercatorParameters</H3></A>
<PRE>public interface SetTransverseMercatorParameters
    module procedure <A HREF="#subroutine_settransversemercatorparameterssystem">SetTransverseMercatorParametersSystem</A>
    module procedure <A HREF="#subroutine_settransversemercatorparameterscoord">SetTransverseMercatorParametersCoord</A>
end interface SetTransverseMercatorParameters
</PRE>
<A NAME="interface_setgaussboagaparameters"><H3>SetGaussBoagaParameters</H3></A>
<PRE>public interface SetGaussBoagaParameters
    module procedure <A HREF="#subroutine_setgaussboagaparameterssystem">SetGaussBoagaParametersSystem</A>
    module procedure <A HREF="#subroutine_setgaussboagaparameterscoord">SetGaussBoagaParametersCoord</A>
end interface SetGaussBoagaParameters
</PRE>
<A NAME="interface_sethotineparameters"><H3>SetHotineParameters</H3></A>
<PRE>public interface SetHotineParameters
    module procedure <A HREF="#subroutine_sethotineparameterssystem">SetHotineParametersSystem</A>
    module procedure <A HREF="#subroutine_sethotineparameterscoord">SetHotineParametersCoord</A>
end interface SetHotineParameters
</PRE>
<A NAME="interface_setswissparameters"><H3>SetSwissParameters</H3></A>
<PRE>public interface SetSwissParameters
    module procedure <A HREF="#subroutine_setswissparameterssystem">SetSwissParametersSystem</A>
    module procedure <A HREF="#subroutine_setswissparameterscoord">SetSwissParametersCoord</A>
end interface SetSwissParameters
</PRE>

<HR><H2> Description of Subroutines and Functions </H2>
<A NAME="subroutine_convert"><H3>Convert</H3></A>
<PRE>public subroutine Convert (input, output)
    type (Coordinate), INTENT(IN) :: input
    type (Coordinate), INTENT(INOUT) :: output
    ! Calls: Catch, ConvertGaussBoagaToGeodetic, ConvertGeodeticToGaussBoaga, ConvertGeodeticToHotine, ConvertGeodeticToSwiss, ConvertGeodeticToTransverseMercator, ConvertGeodeticToUTM, ConvertHotineToGeodetic, ConvertSwissToGeodetic, ConvertTransverseMercatorToGeodetic, ConvertUTMtoGeodetic, GeodeticShiftFromWGS84, GeodeticShiftToWGS84
end subroutine Convert
</PRE>
 Description:
   The subroutine converts the current input coordinates in the coordinate
  system defined by the current input coordinate system parameters and 
  input datum, into output coordinates in the coordinate system defined 
  by the output coordinate system parameters and output datum.
<A NAME="subroutine_geoinit"><H3>GeoInit</H3></A>
<PRE>public subroutine GeoInit (file)
    character (len=*), INTENT (IN) :: file
    ! Calls: Catch, IniClose, IniOpen
end subroutine GeoInit
</PRE>
 Description:
  Initialize parameters for conversion
<A NAME="subroutine_setcrscoord"><H3>SetCRScoord</H3></A>
<PRE>private subroutine SetCRScoord (CRStype, datumType, coord)
    integer, INTENT (IN) :: CRStype
    integer, INTENT (IN) :: datumType
    type (Coordinate), INTENT (INOUT) :: coord
    ! Calls: SetCRSsystem
end subroutine SetCRScoord
</PRE>
 Description:
  Initialize Coordinate Reference System, allocate memory and set parameters
  to default value if necessary. subroutine receives as input a Coordinate
  type argument
<A NAME="subroutine_setcrssystem"><H3>SetCRSsystem</H3></A>
<PRE>private subroutine SetCRSsystem (CRStype, datumType, rs)
    integer, INTENT (IN) :: CRStype
    integer, INTENT (IN) :: datumType
    type (CRS), INTENT (INOUT) :: rs
</PRE>
<DL><DD><DL><DD>
reference system
</DL></DL>
<PRE>    ! Calls: Catch
end subroutine SetCRSsystem
</PRE>
 Description:
  Initialize Coordinate Reference System, allocate memory and set parameters
  to default value if necessary. Subroutine receives as input a CRS
  type argument
<A NAME="subroutine_copycrs"><H3>CopyCRS</H3></A>
<PRE>private subroutine CopyCRS (CRSout, CRSin)
    type (CRS), INTENT (OUT) :: CRSout
    type (CRS), INTENT (IN) :: CRSin
end subroutine CopyCRS
</PRE>
 Description:
  copy the content of a CRS variable in another CRS variable
<A NAME="subroutine_setcoord"><H3>SetCoord</H3></A>
<PRE>public subroutine SetCoord (x, y, coord)
    real (kind=float), INTENT (IN) :: x
</PRE>
<DL><DD><DL><DD>
easting coordinate
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: y
</PRE>
<DL><DD><DL><DD>
northing coordinate
</DL></DL>
<PRE>    type (Coordinate), INTENT(INOUT) :: coord
end subroutine SetCoord
</PRE>
 Description:
   assign easting and northing coordinates
<A NAME="subroutine_copyellipsoid"><H3>CopyEllipsoid</H3></A>
<PRE>private subroutine CopyEllipsoid (ell2, ell1)
    type (Ellipsoid), INTENT(OUT) :: ell2
    type (Ellipsoid), INTENT(IN) :: ell1
end subroutine CopyEllipsoid
</PRE>
 Description:
   Create an exact copy of an ellipsoid.
<A NAME="subroutine_searchellipsoidbycode"><H3>SearchEllipsoidByCode</H3></A>
<PRE>private subroutine SearchEllipsoidByCode (ell, code)
    type (Ellipsoid), INTENT(OUT) :: ell
    integer, INTENT(IN) :: code
    ! Calls: Catch
end subroutine SearchEllipsoidByCode
</PRE>
 Description:
   Search for ellipsoid parameters using a code.
<A NAME="subroutine_copydatum"><H3>CopyDatum</H3></A>
<PRE>private subroutine CopyDatum (datum2, datum1)
    type (Datum), INTENT(OUT) :: datum2
    type (Datum), INTENT(IN) :: datum1
end subroutine CopyDatum
</PRE>
 Description:
   Create an exact copy of a datum.
<A NAME="subroutine_searchdatumbycode"><H3>SearchDatumByCode</H3></A>
<PRE>private subroutine SearchDatumByCode (dat, code)
    type (Datum), INTENT(OUT) :: dat
    integer, INTENT(IN) :: code
    ! Calls: Catch
end subroutine SearchDatumByCode
</PRE>
 Description:
   Search for datum parameters using a code.
<A NAME="subroutine_setgeodeticparameterssystem"><H3>SetGeodeticParametersSystem</H3></A>
<PRE>private subroutine SetGeodeticParametersSystem (system, prime_meridian)
    type (CRS), INTENT (INOUT) :: system
    real (kind=float), INTENT (IN) :: prime_meridian
</PRE>
<DL><DD><DL><DD>
longitude, with respect to Greenwich, of the prime meridian
</DL></DL>
<PRE>end subroutine SetGeodeticParametersSystem
</PRE>
 Description:
   Set parameters for Geodetic reference system
<A NAME="subroutine_setgeodeticparameterscoord"><H3>SetGeodeticParametersCoord</H3></A>
<PRE>private subroutine SetGeodeticParametersCoord (coord, prime_meridian)
    type (Coordinate), INTENT (INOUT) :: coord
    real (kind=float), INTENT (IN) :: prime_meridian
</PRE>
<DL><DD><DL><DD>
longitude, with respect to Greenwich, of the prime meridian
</DL></DL>
<PRE>    ! Calls: SetGeodeticParametersSystem
end subroutine SetGeodeticParametersCoord
</PRE>
 Description:
   Set parameters for Geodetic reference system
<A NAME="subroutine_settransversemercatorparameterssystem"><H3>SetTransverseMercatorParametersSystem</H3></A>
<PRE>private subroutine SetTransverseMercatorParametersSystem (system, lat0, centM, falseE, falseN, k)
    type (CRS), INTENT (INOUT) :: system
    real (kind=float), INTENT (IN) :: lat0
</PRE>
<DL><DD><DL><DD>
Latitude in radians at the origin of the projection
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: centM
</PRE>
<DL><DD><DL><DD>
Longitude in radians at the center of the projection
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: falseE
</PRE>
<DL><DD><DL><DD>
Easting/X at the center of the projection
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: falseN
</PRE>
<DL><DD><DL><DD>
Northing/Y at the center of the projection 
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: k
</PRE>
<DL><DD><DL><DD>
scale factor
</DL></DL>
<PRE>end subroutine SetTransverseMercatorParametersSystem
</PRE>
 Description:
   Set parameters for Transverse Mercator reference system
<A NAME="subroutine_settransversemercatorparameterscoord"><H3>SetTransverseMercatorParametersCoord</H3></A>
<PRE>private subroutine SetTransverseMercatorParametersCoord (coord, lat0, centM, falseE, falseN, k)
    type (Coordinate), INTENT (INOUT) :: coord
    real (kind=float), INTENT (IN) :: lat0
</PRE>
<DL><DD><DL><DD>
Latitude in radians at the origin of the projection
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: centM
</PRE>
<DL><DD><DL><DD>
Longitude in radians at the center of the projection
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: falseE
</PRE>
<DL><DD><DL><DD>
Easting/X at the center of the projection
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: falseN
</PRE>
<DL><DD><DL><DD>
Northing/Y at the center of the projection 
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: k
</PRE>
<DL><DD><DL><DD>
scale factor
</DL></DL>
<PRE>    ! Calls: SetTransverseMercatorParametersSystem
end subroutine SetTransverseMercatorParametersCoord
</PRE>
 Description:
   Set parameters for Transverse Mercator reference system
<A NAME="subroutine_setutmparameterssystem"><H3>SetUTMparametersSystem</H3></A>
<PRE>private subroutine SetUTMparametersSystem (system, zone, hemisphere, override)
    type (CRS), INTENT (INOUT) :: system
    integer (kind=short), INTENT (IN) :: zone
    integer (kind=short), INTENT (IN) :: hemisphere
    integer (kind=short), optional, INTENT (IN) :: override
end subroutine SetUTMparametersSystem
</PRE>
 Description:
   Set parameters for Universal Transverse Mercator reference system
<A NAME="subroutine_setutmparameterscoord"><H3>SetUTMparametersCoord</H3></A>
<PRE>private subroutine SetUTMparametersCoord (coord, zone, hemisphere, override)
    type (Coordinate), INTENT (INOUT) :: coord
    integer (kind=short), INTENT (IN) :: zone
    integer (kind=short), INTENT (IN) :: hemisphere
    integer (kind=short), optional, INTENT (IN) :: override
    ! Calls: SetUTMparametersSystem
end subroutine SetUTMparametersCoord
</PRE>
 Description:
   Set parameters for Universal Transverse Mercator reference system
<A NAME="subroutine_converttransversemercatortogeodetic"><H3>ConvertTransverseMercatorToGeodetic</H3></A>
<PRE>private subroutine ConvertTransverseMercatorToGeodetic (x, y, k, centM, lat0, a, e, eb, falseN, falseE, lon, lat)
    real (kind=float), INTENT (IN) :: x
</PRE>
<DL><DD><DL><DD>
easting coordinate [m]
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: y
</PRE>
<DL><DD><DL><DD>
northing coordinate [m]
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: k
</PRE>
<DL><DD><DL><DD>
scale factor
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: centM
</PRE>
<DL><DD><DL><DD>
central meridian [radians]
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: lat0
</PRE>
<DL><DD><DL><DD>
latitude of origin [radians]
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: a
</PRE>
<DL><DD><DL><DD>
 semimajor axis [m]
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: e
</PRE>
<DL><DD><DL><DD>
 eccentricity
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: eb
</PRE>
<DL><DD><DL><DD>
 second eccentricity
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: falseN
</PRE>
<DL><DD><DL><DD>
false northing
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: falseE
</PRE>
<DL><DD><DL><DD>
false easting
</DL></DL>
<PRE>    real (kind=float), INTENT (OUT) :: lon
</PRE>
<DL><DD><DL><DD>
geodetic longitude [radians]
</DL></DL>
<PRE>    real (kind=float), INTENT (OUT) :: lat
</PRE>
<DL><DD><DL><DD>
geodetic latitude [radians]
</DL></DL>
<PRE>    ! Calls: Catch
end subroutine ConvertTransverseMercatorToGeodetic
</PRE>
 Description:
   The subroutine  converts Transverse Mercator projection 
   (easting and northing) coordinates to geodetic (latitude and longitude)
   coordinates, according to the current ellipsoid and Transverse Mercator 
   projection parameters.  
<A NAME="subroutine_convertgeodetictotransversemercator"><H3>ConvertGeodeticToTransverseMercator</H3></A>
<PRE>private subroutine ConvertGeodeticToTransverseMercator (lon, lat, k, centM, lat0, a, e, eb, falseN, falseE, x, y)
    real (kind=float), INTENT (INOUT) :: lon
</PRE>
<DL><DD><DL><DD>
geodetic longitude [radians]
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: lat
</PRE>
<DL><DD><DL><DD>
geodetic latitude [radians]
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: k
</PRE>
<DL><DD><DL><DD>
scale factor
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: centM
</PRE>
<DL><DD><DL><DD>
central meridian [radians]
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: lat0
</PRE>
<DL><DD><DL><DD>
latitude of origin [radians]
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: a
</PRE>
<DL><DD><DL><DD>
 semimajor axis [m]
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: e
</PRE>
<DL><DD><DL><DD>
 eccentricity
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: eb
</PRE>
<DL><DD><DL><DD>
 second eccentricity
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: falseN
</PRE>
<DL><DD><DL><DD>
false northing
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: falseE
</PRE>
<DL><DD><DL><DD>
false easting
</DL></DL>
<PRE>    real (kind=float), INTENT (OUT) :: x
</PRE>
<DL><DD><DL><DD>
easting coordinate [m]
</DL></DL>
<PRE>    real (kind=float), INTENT (OUT) :: y
</PRE>
<DL><DD><DL><DD>
northing coordinate [m]
</DL></DL>
<PRE>    ! Calls: Catch
end subroutine ConvertGeodeticToTransverseMercator
</PRE>
 Description:
   The subroutine  converts geodetic(latitude and longitude) coordinates 
   to Transverse Mercator projection (easting and northing) coordinates, 
   according to the current ellipsoid and Transverse Mercator projection 
   coordinates.  
<A NAME="subroutine_convertutmtogeodetic"><H3>ConvertUTMtoGeodetic</H3></A>
<PRE>private subroutine ConvertUTMtoGeodetic (x, y, k, centM, lat0, a, e, eb, falseN, falseE, override, lon, lat)
    real (kind=float), INTENT (IN) :: x
</PRE>
<DL><DD><DL><DD>
easting coordinate [m]
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: y
</PRE>
<DL><DD><DL><DD>
northing coordinate [m]
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: k
</PRE>
<DL><DD><DL><DD>
scale factor
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: centM
</PRE>
<DL><DD><DL><DD>
central meridian [radians]
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: lat0
</PRE>
<DL><DD><DL><DD>
latitude of origin [radians]
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: a
</PRE>
<DL><DD><DL><DD>
 semimajor axis [m]
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: e
</PRE>
<DL><DD><DL><DD>
 eccentricity
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: eb
</PRE>
<DL><DD><DL><DD>
 second eccentricity
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: falseN
</PRE>
<DL><DD><DL><DD>
false northing
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: falseE
</PRE>
<DL><DD><DL><DD>
false easting
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: override
</PRE>
<DL><DD><DL><DD>
override option
</DL></DL>
<PRE>    real (kind=float), INTENT (OUT) :: lon
</PRE>
<DL><DD><DL><DD>
geodetic longitude [radians]
</DL></DL>
<PRE>    real (kind=float), INTENT (OUT) :: lat
</PRE>
<DL><DD><DL><DD>
geodetic latitude [radians]
</DL></DL>
<PRE>    ! Calls: Catch, ConvertTransverseMercatorToGeodetic
end subroutine ConvertUTMtoGeodetic
</PRE>
 Description:
   The subroutine  converts Universal Transverse Mercator projection 
   (easting and northing) coordinates to geodetic (latitude and longitude)
   coordinates, according to the current ellipsoid and UTM 
   projection parameters.
<A NAME="subroutine_convertgeodetictoutm"><H3>ConvertGeodeticToUTM</H3></A>
<PRE>private subroutine ConvertGeodeticToUTM (lon, lat, k, centM, lat0, a, e, eb, falseN, falseE, x, y, zone, hemisphere, override)
    real (kind=float), INTENT (INOUT) :: lon
</PRE>
<DL><DD><DL><DD>
geodetic longitude [radians]
</DL></DL>
<PRE>    real (kind=float), INTENT (INOUT) :: lat
</PRE>
<DL><DD><DL><DD>
geodetic latitude [radians]
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: k
</PRE>
<DL><DD><DL><DD>
scale factor
</DL></DL>
<PRE>    real (kind=float), INTENT (INOUT) :: centM
</PRE>
<DL><DD><DL><DD>
central meridian [radians]
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: lat0
</PRE>
<DL><DD><DL><DD>
latitude of origin [radians]
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: a
</PRE>
<DL><DD><DL><DD>
 semimajor axis [m]
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: e
</PRE>
<DL><DD><DL><DD>
 eccentricity
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: eb
</PRE>
<DL><DD><DL><DD>
 second eccentricity
</DL></DL>
<PRE>    real (kind=float), INTENT (INOUT) :: falseN
</PRE>
<DL><DD><DL><DD>
false northing
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: falseE
</PRE>
<DL><DD><DL><DD>
false easting
</DL></DL>
<PRE>    real (kind=float), INTENT (OUT) :: x
</PRE>
<DL><DD><DL><DD>
easting coordinate [m]
</DL></DL>
<PRE>    real (kind=float), INTENT (OUT) :: y
</PRE>
<DL><DD><DL><DD>
northing coordinate [m]
</DL></DL>
<PRE>    real (kind=float), INTENT (INOUT) :: zone
</PRE>
<DL><DD><DL><DD>
zone recalculated if override = 0.
</DL></DL>
<PRE>    real (kind=float), INTENT (INOUT) :: hemisphere
</PRE>
<DL><DD><DL><DD>
hemisphere recalculated if override = 0.
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: override
</PRE>
<DL><DD><DL><DD>
override option
</DL></DL>
<PRE>    ! Calls: Catch, ConvertGeodeticToTransverseMercator
end subroutine ConvertGeodeticToUTM
</PRE>
 Description:
   The subroutine  converts geodetic(latitude and longitude) coordinates 
   to UTM projection (easting and northing) coordinates, 
   according to the current ellipsoid and UTM projection coordinates.
<A NAME="subroutine_setgaussboagaparameterssystem"><H3>SetGaussBoagaparametersSystem</H3></A>
<PRE>private subroutine SetGaussBoagaparametersSystem (system, fuse, override)
    type (CRS), INTENT (INOUT) :: system
    integer (kind=short), INTENT (IN) :: fuse
    integer (kind=short), optional, INTENT (IN) :: override
end subroutine SetGaussBoagaparametersSystem
</PRE>
 Description:
   Set parameters for Gauss Boaga reference system
<A NAME="subroutine_setgaussboagaparameterscoord"><H3>SetGaussBoagaparametersCoord</H3></A>
<PRE>private subroutine SetGaussBoagaparametersCoord (coord, fuse, override)
    type (Coordinate), INTENT (INOUT) :: coord
    integer (kind=short), INTENT (IN) :: fuse
    integer (kind=short), optional, INTENT (IN) :: override
    ! Calls: SetGaussBoagaParametersSystem
end subroutine SetGaussBoagaparametersCoord
</PRE>
 Description:
   Set parameters for Gauss Boaga reference system
<A NAME="subroutine_convertgaussboagatogeodetic"><H3>ConvertGaussBoagaToGeodetic</H3></A>
<PRE>private subroutine ConvertGaussBoagaToGeodetic (x, y, k, centM, lat0, a, e, eb, falseN, falseE, lon, lat)
    real (kind=float), INTENT (IN) :: x
</PRE>
<DL><DD><DL><DD>
easting coordinate [m]
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: y
</PRE>
<DL><DD><DL><DD>
northing coordinate [m]
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: k
</PRE>
<DL><DD><DL><DD>
scale factor
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: centM
</PRE>
<DL><DD><DL><DD>
central meridian [radians]
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: lat0
</PRE>
<DL><DD><DL><DD>
latitude of origin [radians]
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: a
</PRE>
<DL><DD><DL><DD>
 semimajor axis [m]
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: e
</PRE>
<DL><DD><DL><DD>
 eccentricity
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: eb
</PRE>
<DL><DD><DL><DD>
 second eccentricity
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: falseN
</PRE>
<DL><DD><DL><DD>
false northing
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: falseE
</PRE>
<DL><DD><DL><DD>
false easting
</DL></DL>
<PRE>    real (kind=float), INTENT (OUT) :: lon
</PRE>
<DL><DD><DL><DD>
geodetic longitude [radians]
</DL></DL>
<PRE>    real (kind=float), INTENT (OUT) :: lat
</PRE>
<DL><DD><DL><DD>
geodetic latitude [radians]
</DL></DL>
<PRE>    ! Calls: Catch, ConvertTransverseMercatorToGeodetic
end subroutine ConvertGaussBoagaToGeodetic
</PRE>
 Description:
   The subroutine  converts Gauss Boaga projection for Italy
   (easting and northing) coordinates to geodetic (latitude and longitude)
   coordinates
<A NAME="subroutine_convertgeodetictogaussboaga"><H3>ConvertGeodeticToGaussBoaga</H3></A>
<PRE>private subroutine ConvertGeodeticToGaussBoaga (lon, lat, k, centM, lat0, a, e, eb, falseN, falseE, x, y)
    real (kind=float), INTENT (INOUT) :: lon
</PRE>
<DL><DD><DL><DD>
geodetic longitude [radians]
</DL></DL>
<PRE>    real (kind=float), INTENT (INOUT) :: lat
</PRE>
<DL><DD><DL><DD>
geodetic latitude [radians]
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: k
</PRE>
<DL><DD><DL><DD>
scale factor
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: centM
</PRE>
<DL><DD><DL><DD>
central meridian [radians]
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: lat0
</PRE>
<DL><DD><DL><DD>
latitude of origin [radians]
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: a
</PRE>
<DL><DD><DL><DD>
 semimajor axis [m]
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: e
</PRE>
<DL><DD><DL><DD>
 eccentricity
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: eb
</PRE>
<DL><DD><DL><DD>
 second eccentricity
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: falseN
</PRE>
<DL><DD><DL><DD>
false northing
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: falseE
</PRE>
<DL><DD><DL><DD>
false easting
</DL></DL>
<PRE>    real (kind=float), INTENT (OUT) :: x
</PRE>
<DL><DD><DL><DD>
easting coordinate [m]
</DL></DL>
<PRE>    real (kind=float), INTENT (OUT) :: y
</PRE>
<DL><DD><DL><DD>
northing coordinate [m]
</DL></DL>
<PRE>    ! Calls: Catch, ConvertGeodeticToTransverseMercator
end subroutine ConvertGeodeticToGaussBoaga
</PRE>
 Description:
   The subroutine  converts geodetic(latitude and longitude) coordinates 
   to Gauss Boaga (easting and northing) coordinates, 
   according to ROME40 datum for Italy (MonteMario) 
   coordinates.  
<A NAME="subroutine_sethotineparameterssystem"><H3>SetHotineParametersSystem</H3></A>
<PRE>private subroutine SetHotineParametersSystem (system, lat0, centM, azimuth, falseE, falseN, k)
    type (CRS), INTENT (INOUT) :: system
    real (kind=float), INTENT (IN) :: lat0
</PRE>
<DL><DD><DL><DD>
Latitude of projection center [rad]
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: centM
</PRE>
<DL><DD><DL><DD>
Longitude of projection center [rad]
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: azimuth
</PRE>
<DL><DD><DL><DD>
azimuth of centerline
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: falseE
</PRE>
<DL><DD><DL><DD>
Easting/X at the center of the projection
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: falseN
</PRE>
<DL><DD><DL><DD>
Northing/Y at the center of the projection 
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: k
</PRE>
<DL><DD><DL><DD>
scale factor
</DL></DL>
<PRE>end subroutine SetHotineParametersSystem
</PRE>
 Description:
   Set parameters for Hotine Oblique Mercator reference system
<A NAME="subroutine_sethotineparameterscoord"><H3>SetHotineParametersCoord</H3></A>
<PRE>private subroutine SetHotineParametersCoord (coord, lat0, centM, azimuth, falseE, falseN, k)
    type (Coordinate), INTENT (INOUT) :: coord
    real (kind=float), INTENT (IN) :: lat0
</PRE>
<DL><DD><DL><DD>
Latitude of projection center [rad]
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: centM
</PRE>
<DL><DD><DL><DD>
Longitude of projection center [rad]
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: azimuth
</PRE>
<DL><DD><DL><DD>
azimuth of centerline
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: falseE
</PRE>
<DL><DD><DL><DD>
Easting/X at the center of the projection
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: falseN
</PRE>
<DL><DD><DL><DD>
Northing/Y at the center of the projection 
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: k
</PRE>
<DL><DD><DL><DD>
scale factor
</DL></DL>
<PRE>    ! Calls: SetHotineParametersSystem
end subroutine SetHotineParametersCoord
</PRE>
 Description:
   Set parameters for Hotine Oblique Mercator reference system
<A NAME="subroutine_converthotinetogeodetic"><H3>ConvertHotineToGeodetic</H3></A>
<PRE>private subroutine ConvertHotineToGeodetic (x, y, k, lon0, lat0, azimuth, a, e, falseN, falseE, lon, lat)
    real (kind=float), INTENT (IN) :: x
</PRE>
<DL><DD><DL><DD>
easting coordinate [m]
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: y
</PRE>
<DL><DD><DL><DD>
northing coordinate [m]
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: k
</PRE>
<DL><DD><DL><DD>
scale factor
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: lon0
</PRE>
<DL><DD><DL><DD>
longitude of center [radians]
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: lat0
</PRE>
<DL><DD><DL><DD>
latitude of center [radians]
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: azimuth
</PRE>
<DL><DD><DL><DD>
azimuth of centerline
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: a
</PRE>
<DL><DD><DL><DD>
 semimajor axis [m]
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: e
</PRE>
<DL><DD><DL><DD>
 eccentricity
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: falseN
</PRE>
<DL><DD><DL><DD>
false northing
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: falseE
</PRE>
<DL><DD><DL><DD>
false easting
</DL></DL>
<PRE>    real (kind=float), INTENT (OUT) :: lon
</PRE>
<DL><DD><DL><DD>
geodetic longitude [radians]
</DL></DL>
<PRE>    real (kind=float), INTENT (OUT) :: lat
</PRE>
<DL><DD><DL><DD>
geodetic latitude [radians]
</DL></DL>
<PRE>    ! Calls: Catch
end subroutine ConvertHotineToGeodetic
</PRE>
 Description:
   The subroutine  converts Hotine Oblique Mercator projection 
   (easting and northing) coordinates to geodetic (latitude and longitude)
   coordinates  
<A NAME="subroutine_convertgeodetictohotine"><H3>ConvertGeodeticToHotine</H3></A>
<PRE>private subroutine ConvertGeodeticToHotine (lon, lat, k, lon0, lat0, azimuth, a, e, falseN, falseE, x, y)
    real (kind=float), INTENT (IN) :: lon
</PRE>
<DL><DD><DL><DD>
geodetic longitude [radians]
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: lat
</PRE>
<DL><DD><DL><DD>
geodetic latitude [radians]
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: k
</PRE>
<DL><DD><DL><DD>
scale factor
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: lon0
</PRE>
<DL><DD><DL><DD>
longitude of center [radians]
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: lat0
</PRE>
<DL><DD><DL><DD>
latitude of center [radians]
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: azimuth
</PRE>
<DL><DD><DL><DD>
azimuth of centerline
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: a
</PRE>
<DL><DD><DL><DD>
 semimajor axis [m]
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: e
</PRE>
<DL><DD><DL><DD>
 eccentricity
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: falseN
</PRE>
<DL><DD><DL><DD>
false northing
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: falseE
</PRE>
<DL><DD><DL><DD>
false easting
</DL></DL>
<PRE>    real (kind=float), INTENT (OUT) :: x
</PRE>
<DL><DD><DL><DD>
easting coordinate [m]
</DL></DL>
<PRE>    real (kind=float), INTENT (OUT) :: y
</PRE>
<DL><DD><DL><DD>
northing coordinate [m]
</DL></DL>
<PRE>end subroutine ConvertGeodeticToHotine
</PRE>
 Description:
   The subroutine  converts geodetic (latitude and longitude)
   coordinates  to Hotine Oblique Mercator projection 
   (easting and northing)
<A NAME="subroutine_setswissparameterssystem"><H3>SetSwissParametersSystem</H3></A>
<PRE>private subroutine SetSwissParametersSystem (system, latc, lonc, azimuth, falseE, falseN, k)
    type (CRS), INTENT (INOUT) :: system
    real (kind=float), INTENT (IN) :: latc
</PRE>
<DL><DD><DL><DD>
Latitude of projection center [rad]
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: lonc
</PRE>
<DL><DD><DL><DD>
Longitude of projection center [rad]
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: azimuth
</PRE>
<DL><DD><DL><DD>
azimuth of centerline
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: falseE
</PRE>
<DL><DD><DL><DD>
Easting/X at the center of the projection
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: falseN
</PRE>
<DL><DD><DL><DD>
Northing/Y at the center of the projection 
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: k
</PRE>
<DL><DD><DL><DD>
scale factor
</DL></DL>
<PRE>end subroutine SetSwissParametersSystem
</PRE>
 Description:
   Set parameters for Swiss Oblique Cylindrical reference system
<A NAME="subroutine_setswissparameterscoord"><H3>SetSwissParametersCoord</H3></A>
<PRE>private subroutine SetSwissParametersCoord (coord, latc, lonc, azimuth, falseE, falseN, k)
    type (Coordinate), INTENT (INOUT) :: coord
    real (kind=float), INTENT (IN) :: latc
</PRE>
<DL><DD><DL><DD>
Latitude of projection center [rad]
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: lonc
</PRE>
<DL><DD><DL><DD>
Longitude of projection center [rad]
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: azimuth
</PRE>
<DL><DD><DL><DD>
azimuth of centerline
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: falseE
</PRE>
<DL><DD><DL><DD>
Easting/X at the center of the projection
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: falseN
</PRE>
<DL><DD><DL><DD>
Northing/Y at the center of the projection 
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: k
</PRE>
<DL><DD><DL><DD>
scale factor
</DL></DL>
<PRE>    ! Calls: SetHotineParametersSystem
end subroutine SetSwissParametersCoord
</PRE>
 Description:
   Set parameters for Swiss Oblique Cylindrical reference system
<A NAME="subroutine_convertswisstogeodetic"><H3>ConvertSwissToGeodetic</H3></A>
<PRE>private subroutine ConvertSwissToGeodetic (x, y, k, lon0, lat0, azimuth, a, e, falseN, falseE, lon, lat)
    real (kind=float), INTENT (IN) :: x
</PRE>
<DL><DD><DL><DD>
easting coordinate [m]
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: y
</PRE>
<DL><DD><DL><DD>
northing coordinate [m]
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: k
</PRE>
<DL><DD><DL><DD>
scale factor
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: lon0
</PRE>
<DL><DD><DL><DD>
longitude of center [radians]
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: lat0
</PRE>
<DL><DD><DL><DD>
latitude of center [radians]
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: azimuth
</PRE>
<DL><DD><DL><DD>
azimuth of centerline
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: a
</PRE>
<DL><DD><DL><DD>
 semimajor axis [m]
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: e
</PRE>
<DL><DD><DL><DD>
 eccentricity
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: falseN
</PRE>
<DL><DD><DL><DD>
false northing
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: falseE
</PRE>
<DL><DD><DL><DD>
false easting
</DL></DL>
<PRE>    real (kind=float), INTENT (OUT) :: lon
</PRE>
<DL><DD><DL><DD>
geodetic longitude [radians]
</DL></DL>
<PRE>    real (kind=float), INTENT (OUT) :: lat
</PRE>
<DL><DD><DL><DD>
geodetic latitude [radians]
</DL></DL>
<PRE>    ! Calls: Catch
end subroutine ConvertSwissToGeodetic
</PRE>
 Description:
   The subroutine  converts Swiss Oblique Cylindrical projection 
   (easting and northing) coordinates to geodetic (latitude and longitude)
   coordinates  
 Reference:
    Federal Office of Topography, Formulas and constants for the calculation
    of the Swiss conformal cylindrical projection and for the transormation
    between coordinate systems
    http://www.swisstopo.admin.ch/internet/swisstopo/en/home/topics/survey/sys/refsys.html
<A NAME="subroutine_convertgeodetictoswiss"><H3>ConvertGeodeticToSwiss</H3></A>
<PRE>public subroutine ConvertGeodeticToSwiss (lon, lat, k, lon0, lat0, azimuth, a, e, falseN, falseE, x, y)
    real (kind=float), INTENT (IN) :: lon
</PRE>
<DL><DD><DL><DD>
geodetic longitude [radians]
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: lat
</PRE>
<DL><DD><DL><DD>
geodetic latitude [radians]
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: k
</PRE>
<DL><DD><DL><DD>
scale factor
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: lon0
</PRE>
<DL><DD><DL><DD>
longitude of center [radians]
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: lat0
</PRE>
<DL><DD><DL><DD>
latitude of center [radians]
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: azimuth
</PRE>
<DL><DD><DL><DD>
azimuth of centerline
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: a
</PRE>
<DL><DD><DL><DD>
 semimajor axis [m]
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: e
</PRE>
<DL><DD><DL><DD>
 eccentricity
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: falseN
</PRE>
<DL><DD><DL><DD>
false northing
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: falseE
</PRE>
<DL><DD><DL><DD>
false easting
</DL></DL>
<PRE>    real (kind=float), INTENT (OUT) :: x
</PRE>
<DL><DD><DL><DD>
easting coordinate [m]
</DL></DL>
<PRE>    real (kind=float), INTENT (OUT) :: y
</PRE>
<DL><DD><DL><DD>
northing coordinate [m]
</DL></DL>
<PRE>end subroutine ConvertGeodeticToSwiss
</PRE>
 Description:
   The subroutine  converts geodetic (latitude and longitude) to 
   Swiss Oblique Cylindrical projection(easting and northing) coordinates   
 Reference:
    Federal Office of Topography, Formulas and constants for the calculation
    of the Swiss conformal cylindrical projection and for the transormation
    between coordinate systems
    http://www.swisstopo.admin.ch/internet/swisstopo/en/home/topics/survey/sys/refsys.html
<P>
<A NAME="function_rho"><H3>Rho</H3></A>
<PRE>private function Rho (lat, a, e) result (radius)
    real (kind=float), INTENT (IN) :: lat
</PRE>
<DL><DD><DL><DD>
latitude [radians]
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: a
</PRE>
<DL><DD><DL><DD>
semimajor axis [m]
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: e
</PRE>
<DL><DD><DL><DD>
exentricity
</DL></DL>
<PRE>    real (kind=float) :: radius
end function Rho
</PRE>
 Description:
   Compute the radius of curvature of the ellipsoid in the plane of 
   the meridian at given latitude 
<A NAME="function_nu"><H3>Nu</H3></A>
<PRE>private function Nu (lat, a, e) result (radius)
    real (kind=float), INTENT (IN) :: lat
</PRE>
<DL><DD><DL><DD>
latitude [radians]
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: a
</PRE>
<DL><DD><DL><DD>
semimajor axis [m]
</DL></DL>
<PRE>    real (kind=float), INTENT (IN) :: e
</PRE>
<DL><DD><DL><DD>
eccentricity
</DL></DL>
<PRE>    real (kind=float) :: radius
end function Nu
</PRE>
 Description:
   Compute the radius of curvature of the ellipsoid perpendicular to 
   the meridian at given latitude 
<A NAME="function_meridionaldistance"><H3>MeridionalDistance</H3></A>
<PRE>private function MeridionalDistance (lat, a, e) result (M)
    real (kind=float), INTENT(IN) :: lat
</PRE>
<DL><DD><DL><DD>
latitude in [radians]
</DL></DL>
<PRE>    real (kind=float), INTENT(IN) :: a
</PRE>
<DL><DD><DL><DD>
 semimajor axis [m]
</DL></DL>
<PRE>    real (kind=float), INTENT(IN) :: e
</PRE>
<DL><DD><DL><DD>
 exentricity
</DL></DL>
<PRE>    real (kind=float) :: M
</PRE>
<DL><DD><DL><DD>
meridional distance [m]
</DL></DL>
<PRE>end function MeridionalDistance
</PRE>
 Description:
   Compute the distance in meters along a meridian from equator 
   to given latitude.
 References:
   Snyder, J.P, (1987). Map Projections - A working manual, 
   U.S. Geological Survey Professional Paper 1395.
<A NAME="subroutine_geodeticshifttowgs84"><H3>GeodeticShiftToWGS84</H3></A>
<PRE>private subroutine GeodeticShiftToWGS84 (input, latIn, lonIn, WGS84lat, WGS84lon)
    type (Coordinate), INTENT(IN) :: input
    real (kind=float), INTENT(IN) :: latIn
    real (kind=float), INTENT(IN) :: lonIn
    real (kind=float), INTENT(OUT) :: WGS84lat
    real (kind=float), INTENT(OUT) :: WGS84lon
    ! Calls: MolodenskyShift
end subroutine GeodeticShiftToWGS84
</PRE>
 Description:
   shifts geodetic coordinates relative to a given source datum
   to geodetic coordinates relative to WGS84.
<A NAME="subroutine_geodeticshiftfromwgs84"><H3>GeodeticShiftFromWGS84</H3></A>
<PRE>private subroutine GeodeticShiftFromWGS84 (input, WGS84lat, WGS84lon, latOut, lonOut)
    type (Coordinate), INTENT(IN) :: input
    real (kind=float), INTENT(IN) :: WGS84lat
    real (kind=float), INTENT(IN) :: WGS84lon
    real (kind=float), INTENT(OUT) :: latOut
    real (kind=float), INTENT(OUT) :: lonOut
    ! Calls: MolodenskyShift
end subroutine GeodeticShiftFromWGS84
</PRE>
 Description:
   shifts geodetic coordinates relative to WGS84
   to geodetic coordinates relative to a given local datum.
<A NAME="subroutine_molodenskyshift"><H3>MolodenskyShift</H3></A>
<PRE>private subroutine MolodenskyShift (a, da, f, df, dx, dy, dz, Lat_in, Lon_in, Hgt_in, WGS84_Lat, WGS84_Lon, WGS84_Hgt)
    real (kind=float), INTENT (IN) :: a
    real (kind=float), INTENT (IN) :: da
    real (kind=float), INTENT (IN) :: f
    real (kind=float), INTENT (IN) :: df
    real (kind=float), INTENT (IN) :: dx
    real (kind=float), INTENT (IN) :: dy
    real (kind=float), INTENT (IN) :: dz
    real (kind=float), INTENT (IN) :: Lat_in
    real (kind=float), INTENT (IN) :: Lon_in
    real (kind=float), INTENT (IN) :: Hgt_in
    real (kind=float), INTENT (OUT) :: WGS84_Lat
    real (kind=float), INTENT (OUT) :: WGS84_Lon
    real (kind=float), INTENT (OUT) :: WGS84_Hgt
end subroutine MolodenskyShift
</PRE>
 Description:
   shifts geodetic coordinates using the Molodensky method
<A NAME="function_crsisequal"><H3>CRSisEqual</H3></A>
<PRE>private function CRSisEqual (CRS1, CRS2) result (isEqual)
    type (CRS), INTENT(IN) :: CRS1
    type (CRS), INTENT(IN) :: CRS2
    logical :: isEqual
end function CRSisEqual
</PRE>
 Description:
  return .TRUE. if the two coordinate reference systems are equal
<A NAME="function_ellipsoidisequal"><H3>EllipsoidIsEqual</H3></A>
<PRE>private function EllipsoidIsEqual (ellps1, ellps2) result (isEqual)
    type (Ellipsoid), INTENT(IN) :: ellps1
    type (Ellipsoid), INTENT(IN) :: ellps2
    logical :: isEqual
end function EllipsoidIsEqual
</PRE>
 Description:
  return .TRUE. if the two ellipsoids are equal
<A NAME="function_datumisequal"><H3>DatumIsEqual</H3></A>
<PRE>private function DatumIsEqual (datum1, datum2) result (isEqual)
    type (Datum), INTENT(IN) :: datum1
    type (Datum), INTENT(IN) :: datum2
    logical :: isEqual
end function DatumIsEqual
</PRE>
 Description:
  return .TRUE. if the two datums are equal
<A NAME="function_scandatum"><H3>ScanDatum</H3></A>
<PRE>public function ScanDatum (datumString) result (datumCode)
    character (len=*), INTENT (IN) :: datumString
    integer :: datumCode
end function ScanDatum
</PRE>
 Description:
  return datum numeric code given a string
<A NAME="function_distance"><H3>Distance</H3></A>
<PRE>public function Distance (point1, point2)
    type (Coordinate), INTENT (IN) :: point1
    type (Coordinate), INTENT (IN) :: point2
    real (kind=double) :: distance
end function Distance
</PRE>
 Description:
   compute distance between two points in, either, projected or geodetic
   coordinate reference system
</HTML>
